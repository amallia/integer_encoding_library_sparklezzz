/*
 * AFOR_pack.hpp
 *  pack small endian
 *  Created on: 2013-5-3
 *      Author: zxd
 */

#ifndef AFOR_PACK_HPP_
#define AFOR_PACK_HPP_

namespace paradise {
namespace index {

template<typename T>
void AFOR_pack_32_1(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1);
	des[0] |= (src[1] & 1) << 1;
	des[0] |= (src[2] & 1) << 2;
	des[0] |= (src[3] & 1) << 3;
	des[0] |= (src[4] & 1) << 4;
	des[0] |= (src[5] & 1) << 5;
	des[0] |= (src[6] & 1) << 6;
	des[0] |= (src[7] & 1) << 7;
	des[0] |= (src[8] & 1) << 8;
	des[0] |= (src[9] & 1) << 9;
	des[0] |= (src[10] & 1) << 10;
	des[0] |= (src[11] & 1) << 11;
	des[0] |= (src[12] & 1) << 12;
	des[0] |= (src[13] & 1) << 13;
	des[0] |= (src[14] & 1) << 14;
	des[0] |= (src[15] & 1) << 15;
	des[0] |= (src[16] & 1) << 16;
	des[0] |= (src[17] & 1) << 17;
	des[0] |= (src[18] & 1) << 18;
	des[0] |= (src[19] & 1) << 19;
	des[0] |= (src[20] & 1) << 20;
	des[0] |= (src[21] & 1) << 21;
	des[0] |= (src[22] & 1) << 22;
	des[0] |= (src[23] & 1) << 23;
	des[0] |= (src[24] & 1) << 24;
	des[0] |= (src[25] & 1) << 25;
	des[0] |= (src[26] & 1) << 26;
	des[0] |= (src[27] & 1) << 27;
	des[0] |= (src[28] & 1) << 28;
	des[0] |= (src[29] & 1) << 29;
	des[0] |= (src[30] & 1) << 30;
	des[0] |= (src[31] & 1) << 31;
}

template<typename T>
void AFOR_pack_32_2(uint32_t * des, const T *src) {
	des[0] = (src[0] & 3);
	des[0] |= (src[1] & 3) << 2;
	des[0] |= (src[2] & 3) << 4;
	des[0] |= (src[3] & 3) << 6;
	des[0] |= (src[4] & 3) << 8;
	des[0] |= (src[5] & 3) << 10;
	des[0] |= (src[6] & 3) << 12;
	des[0] |= (src[7] & 3) << 14;
	des[0] |= (src[8] & 3) << 16;
	des[0] |= (src[9] & 3) << 18;
	des[0] |= (src[10] & 3) << 20;
	des[0] |= (src[11] & 3) << 22;
	des[0] |= (src[12] & 3) << 24;
	des[0] |= (src[13] & 3) << 26;
	des[0] |= (src[14] & 3) << 28;
	des[0] |= (src[15] & 3) << 30;
	des[1] = (src[16] & 3);
	des[1] |= (src[17] & 3) << 2;
	des[1] |= (src[18] & 3) << 4;
	des[1] |= (src[19] & 3) << 6;
	des[1] |= (src[20] & 3) << 8;
	des[1] |= (src[21] & 3) << 10;
	des[1] |= (src[22] & 3) << 12;
	des[1] |= (src[23] & 3) << 14;
	des[1] |= (src[24] & 3) << 16;
	des[1] |= (src[25] & 3) << 18;
	des[1] |= (src[26] & 3) << 20;
	des[1] |= (src[27] & 3) << 22;
	des[1] |= (src[28] & 3) << 24;
	des[1] |= (src[29] & 3) << 26;
	des[1] |= (src[30] & 3) << 28;
	des[1] |= (src[31] & 3) << 30;
}

template<typename T>
void AFOR_pack_32_3(uint32_t * des, const T *src) {
	des[0] = (src[0] & 7);
	des[0] |= (src[1] & 7) << 3;
	des[0] |= (src[2] & 7) << 6;
	des[0] |= (src[3] & 7) << 9;
	des[0] |= (src[4] & 7) << 12;
	des[0] |= (src[5] & 7) << 15;
	des[0] |= (src[6] & 7) << 18;
	des[0] |= (src[7] & 7) << 21;
	des[0] |= (src[8] & 7) << 24;
	des[0] |= (src[9] & 7) << 27;
	des[0] |= (src[10] & 7) << 30;
	des[1] = (src[10] & 7) >> 2;
	des[1] |= (src[11] & 7) << 1;
	des[1] |= (src[12] & 7) << 4;
	des[1] |= (src[13] & 7) << 7;
	des[1] |= (src[14] & 7) << 10;
	des[1] |= (src[15] & 7) << 13;
	des[1] |= (src[16] & 7) << 16;
	des[1] |= (src[17] & 7) << 19;
	des[1] |= (src[18] & 7) << 22;
	des[1] |= (src[19] & 7) << 25;
	des[1] |= (src[20] & 7) << 28;
	des[1] |= (src[21] & 7) << 31;
	des[2] = (src[21] & 7) >> 1;
	des[2] |= (src[22] & 7) << 2;
	des[2] |= (src[23] & 7) << 5;
	des[2] |= (src[24] & 7) << 8;
	des[2] |= (src[25] & 7) << 11;
	des[2] |= (src[26] & 7) << 14;
	des[2] |= (src[27] & 7) << 17;
	des[2] |= (src[28] & 7) << 20;
	des[2] |= (src[29] & 7) << 23;
	des[2] |= (src[30] & 7) << 26;
	des[2] |= (src[31] & 7) << 29;
}

template<typename T>
void AFOR_pack_32_4(uint32_t * des, const T *src) {
	des[0] = (src[0] & 15);
	des[0] |= (src[1] & 15) << 4;
	des[0] |= (src[2] & 15) << 8;
	des[0] |= (src[3] & 15) << 12;
	des[0] |= (src[4] & 15) << 16;
	des[0] |= (src[5] & 15) << 20;
	des[0] |= (src[6] & 15) << 24;
	des[0] |= (src[7] & 15) << 28;
	des[1] = (src[8] & 15);
	des[1] |= (src[9] & 15) << 4;
	des[1] |= (src[10] & 15) << 8;
	des[1] |= (src[11] & 15) << 12;
	des[1] |= (src[12] & 15) << 16;
	des[1] |= (src[13] & 15) << 20;
	des[1] |= (src[14] & 15) << 24;
	des[1] |= (src[15] & 15) << 28;
	des[2] = (src[16] & 15);
	des[2] |= (src[17] & 15) << 4;
	des[2] |= (src[18] & 15) << 8;
	des[2] |= (src[19] & 15) << 12;
	des[2] |= (src[20] & 15) << 16;
	des[2] |= (src[21] & 15) << 20;
	des[2] |= (src[22] & 15) << 24;
	des[2] |= (src[23] & 15) << 28;
	des[3] = (src[24] & 15);
	des[3] |= (src[25] & 15) << 4;
	des[3] |= (src[26] & 15) << 8;
	des[3] |= (src[27] & 15) << 12;
	des[3] |= (src[28] & 15) << 16;
	des[3] |= (src[29] & 15) << 20;
	des[3] |= (src[30] & 15) << 24;
	des[3] |= (src[31] & 15) << 28;
}

template<typename T>
void AFOR_pack_32_5(uint32_t * des, const T *src) {
	des[0] = (src[0] & 31);
	des[0] |= (src[1] & 31) << 5;
	des[0] |= (src[2] & 31) << 10;
	des[0] |= (src[3] & 31) << 15;
	des[0] |= (src[4] & 31) << 20;
	des[0] |= (src[5] & 31) << 25;
	des[0] |= (src[6] & 31) << 30;
	des[1] = (src[6] & 31) >> 2;
	des[1] |= (src[7] & 31) << 3;
	des[1] |= (src[8] & 31) << 8;
	des[1] |= (src[9] & 31) << 13;
	des[1] |= (src[10] & 31) << 18;
	des[1] |= (src[11] & 31) << 23;
	des[1] |= (src[12] & 31) << 28;
	des[2] = (src[12] & 31) >> 4;
	des[2] |= (src[13] & 31) << 1;
	des[2] |= (src[14] & 31) << 6;
	des[2] |= (src[15] & 31) << 11;
	des[2] |= (src[16] & 31) << 16;
	des[2] |= (src[17] & 31) << 21;
	des[2] |= (src[18] & 31) << 26;
	des[2] |= (src[19] & 31) << 31;
	des[3] = (src[19] & 31) >> 1;
	des[3] |= (src[20] & 31) << 4;
	des[3] |= (src[21] & 31) << 9;
	des[3] |= (src[22] & 31) << 14;
	des[3] |= (src[23] & 31) << 19;
	des[3] |= (src[24] & 31) << 24;
	des[3] |= (src[25] & 31) << 29;
	des[4] = (src[25] & 31) >> 3;
	des[4] |= (src[26] & 31) << 2;
	des[4] |= (src[27] & 31) << 7;
	des[4] |= (src[28] & 31) << 12;
	des[4] |= (src[29] & 31) << 17;
	des[4] |= (src[30] & 31) << 22;
	des[4] |= (src[31] & 31) << 27;
}

template<typename T>
void AFOR_pack_32_6(uint32_t * des, const T *src) {
	des[0] = (src[0] & 63);
	des[0] |= (src[1] & 63) << 6;
	des[0] |= (src[2] & 63) << 12;
	des[0] |= (src[3] & 63) << 18;
	des[0] |= (src[4] & 63) << 24;
	des[0] |= (src[5] & 63) << 30;
	des[1] = (src[5] & 63) >> 2;
	des[1] |= (src[6] & 63) << 4;
	des[1] |= (src[7] & 63) << 10;
	des[1] |= (src[8] & 63) << 16;
	des[1] |= (src[9] & 63) << 22;
	des[1] |= (src[10] & 63) << 28;
	des[2] = (src[10] & 63) >> 4;
	des[2] |= (src[11] & 63) << 2;
	des[2] |= (src[12] & 63) << 8;
	des[2] |= (src[13] & 63) << 14;
	des[2] |= (src[14] & 63) << 20;
	des[2] |= (src[15] & 63) << 26;
	des[3] = (src[16] & 63);
	des[3] |= (src[17] & 63) << 6;
	des[3] |= (src[18] & 63) << 12;
	des[3] |= (src[19] & 63) << 18;
	des[3] |= (src[20] & 63) << 24;
	des[3] |= (src[21] & 63) << 30;
	des[4] = (src[21] & 63) >> 2;
	des[4] |= (src[22] & 63) << 4;
	des[4] |= (src[23] & 63) << 10;
	des[4] |= (src[24] & 63) << 16;
	des[4] |= (src[25] & 63) << 22;
	des[4] |= (src[26] & 63) << 28;
	des[5] = (src[26] & 63) >> 4;
	des[5] |= (src[27] & 63) << 2;
	des[5] |= (src[28] & 63) << 8;
	des[5] |= (src[29] & 63) << 14;
	des[5] |= (src[30] & 63) << 20;
	des[5] |= (src[31] & 63) << 26;
}

template<typename T>
void AFOR_pack_32_7(uint32_t * des, const T *src) {
	des[0] = (src[0] & 127);
	des[0] |= (src[1] & 127) << 7;
	des[0] |= (src[2] & 127) << 14;
	des[0] |= (src[3] & 127) << 21;
	des[0] |= (src[4] & 127) << 28;
	des[1] = (src[4] & 127) >> 4;
	des[1] |= (src[5] & 127) << 3;
	des[1] |= (src[6] & 127) << 10;
	des[1] |= (src[7] & 127) << 17;
	des[1] |= (src[8] & 127) << 24;
	des[1] |= (src[9] & 127) << 31;
	des[2] = (src[9] & 127) >> 1;
	des[2] |= (src[10] & 127) << 6;
	des[2] |= (src[11] & 127) << 13;
	des[2] |= (src[12] & 127) << 20;
	des[2] |= (src[13] & 127) << 27;
	des[3] = (src[13] & 127) >> 5;
	des[3] |= (src[14] & 127) << 2;
	des[3] |= (src[15] & 127) << 9;
	des[3] |= (src[16] & 127) << 16;
	des[3] |= (src[17] & 127) << 23;
	des[3] |= (src[18] & 127) << 30;
	des[4] = (src[18] & 127) >> 2;
	des[4] |= (src[19] & 127) << 5;
	des[4] |= (src[20] & 127) << 12;
	des[4] |= (src[21] & 127) << 19;
	des[4] |= (src[22] & 127) << 26;
	des[5] = (src[22] & 127) >> 6;
	des[5] |= (src[23] & 127) << 1;
	des[5] |= (src[24] & 127) << 8;
	des[5] |= (src[25] & 127) << 15;
	des[5] |= (src[26] & 127) << 22;
	des[5] |= (src[27] & 127) << 29;
	des[6] = (src[27] & 127) >> 3;
	des[6] |= (src[28] & 127) << 4;
	des[6] |= (src[29] & 127) << 11;
	des[6] |= (src[30] & 127) << 18;
	des[6] |= (src[31] & 127) << 25;
}

template<typename T>
void AFOR_pack_32_8(uint32_t * des, const T *src) {
	des[0] = (src[0] & 255);
	des[0] |= (src[1] & 255) << 8;
	des[0] |= (src[2] & 255) << 16;
	des[0] |= (src[3] & 255) << 24;
	des[1] = (src[4] & 255);
	des[1] |= (src[5] & 255) << 8;
	des[1] |= (src[6] & 255) << 16;
	des[1] |= (src[7] & 255) << 24;
	des[2] = (src[8] & 255);
	des[2] |= (src[9] & 255) << 8;
	des[2] |= (src[10] & 255) << 16;
	des[2] |= (src[11] & 255) << 24;
	des[3] = (src[12] & 255);
	des[3] |= (src[13] & 255) << 8;
	des[3] |= (src[14] & 255) << 16;
	des[3] |= (src[15] & 255) << 24;
	des[4] = (src[16] & 255);
	des[4] |= (src[17] & 255) << 8;
	des[4] |= (src[18] & 255) << 16;
	des[4] |= (src[19] & 255) << 24;
	des[5] = (src[20] & 255);
	des[5] |= (src[21] & 255) << 8;
	des[5] |= (src[22] & 255) << 16;
	des[5] |= (src[23] & 255) << 24;
	des[6] = (src[24] & 255);
	des[6] |= (src[25] & 255) << 8;
	des[6] |= (src[26] & 255) << 16;
	des[6] |= (src[27] & 255) << 24;
	des[7] = (src[28] & 255);
	des[7] |= (src[29] & 255) << 8;
	des[7] |= (src[30] & 255) << 16;
	des[7] |= (src[31] & 255) << 24;
}

template<typename T>
void AFOR_pack_32_9(uint32_t * des, const T *src) {
	des[0] = (src[0] & 511);
	des[0] |= (src[1] & 511) << 9;
	des[0] |= (src[2] & 511) << 18;
	des[0] |= (src[3] & 511) << 27;
	des[1] = (src[3] & 511) >> 5;
	des[1] |= (src[4] & 511) << 4;
	des[1] |= (src[5] & 511) << 13;
	des[1] |= (src[6] & 511) << 22;
	des[1] |= (src[7] & 511) << 31;
	des[2] = (src[7] & 511) >> 1;
	des[2] |= (src[8] & 511) << 8;
	des[2] |= (src[9] & 511) << 17;
	des[2] |= (src[10] & 511) << 26;
	des[3] = (src[10] & 511) >> 6;
	des[3] |= (src[11] & 511) << 3;
	des[3] |= (src[12] & 511) << 12;
	des[3] |= (src[13] & 511) << 21;
	des[3] |= (src[14] & 511) << 30;
	des[4] = (src[14] & 511) >> 2;
	des[4] |= (src[15] & 511) << 7;
	des[4] |= (src[16] & 511) << 16;
	des[4] |= (src[17] & 511) << 25;
	des[5] = (src[17] & 511) >> 7;
	des[5] |= (src[18] & 511) << 2;
	des[5] |= (src[19] & 511) << 11;
	des[5] |= (src[20] & 511) << 20;
	des[5] |= (src[21] & 511) << 29;
	des[6] = (src[21] & 511) >> 3;
	des[6] |= (src[22] & 511) << 6;
	des[6] |= (src[23] & 511) << 15;
	des[6] |= (src[24] & 511) << 24;
	des[7] = (src[24] & 511) >> 8;
	des[7] |= (src[25] & 511) << 1;
	des[7] |= (src[26] & 511) << 10;
	des[7] |= (src[27] & 511) << 19;
	des[7] |= (src[28] & 511) << 28;
	des[8] = (src[28] & 511) >> 4;
	des[8] |= (src[29] & 511) << 5;
	des[8] |= (src[30] & 511) << 14;
	des[8] |= (src[31] & 511) << 23;
}

template<typename T>
void AFOR_pack_32_10(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1023);
	des[0] |= (src[1] & 1023) << 10;
	des[0] |= (src[2] & 1023) << 20;
	des[0] |= (src[3] & 1023) << 30;
	des[1] = (src[3] & 1023) >> 2;
	des[1] |= (src[4] & 1023) << 8;
	des[1] |= (src[5] & 1023) << 18;
	des[1] |= (src[6] & 1023) << 28;
	des[2] = (src[6] & 1023) >> 4;
	des[2] |= (src[7] & 1023) << 6;
	des[2] |= (src[8] & 1023) << 16;
	des[2] |= (src[9] & 1023) << 26;
	des[3] = (src[9] & 1023) >> 6;
	des[3] |= (src[10] & 1023) << 4;
	des[3] |= (src[11] & 1023) << 14;
	des[3] |= (src[12] & 1023) << 24;
	des[4] = (src[12] & 1023) >> 8;
	des[4] |= (src[13] & 1023) << 2;
	des[4] |= (src[14] & 1023) << 12;
	des[4] |= (src[15] & 1023) << 22;
	des[5] = (src[16] & 1023);
	des[5] |= (src[17] & 1023) << 10;
	des[5] |= (src[18] & 1023) << 20;
	des[5] |= (src[19] & 1023) << 30;
	des[6] = (src[19] & 1023) >> 2;
	des[6] |= (src[20] & 1023) << 8;
	des[6] |= (src[21] & 1023) << 18;
	des[6] |= (src[22] & 1023) << 28;
	des[7] = (src[22] & 1023) >> 4;
	des[7] |= (src[23] & 1023) << 6;
	des[7] |= (src[24] & 1023) << 16;
	des[7] |= (src[25] & 1023) << 26;
	des[8] = (src[25] & 1023) >> 6;
	des[8] |= (src[26] & 1023) << 4;
	des[8] |= (src[27] & 1023) << 14;
	des[8] |= (src[28] & 1023) << 24;
	des[9] = (src[28] & 1023) >> 8;
	des[9] |= (src[29] & 1023) << 2;
	des[9] |= (src[30] & 1023) << 12;
	des[9] |= (src[31] & 1023) << 22;
}

template<typename T>
void AFOR_pack_32_11(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2047);
	des[0] |= (src[1] & 2047) << 11;
	des[0] |= (src[2] & 2047) << 22;
	des[1] = (src[2] & 2047) >> 10;
	des[1] |= (src[3] & 2047) << 1;
	des[1] |= (src[4] & 2047) << 12;
	des[1] |= (src[5] & 2047) << 23;
	des[2] = (src[5] & 2047) >> 9;
	des[2] |= (src[6] & 2047) << 2;
	des[2] |= (src[7] & 2047) << 13;
	des[2] |= (src[8] & 2047) << 24;
	des[3] = (src[8] & 2047) >> 8;
	des[3] |= (src[9] & 2047) << 3;
	des[3] |= (src[10] & 2047) << 14;
	des[3] |= (src[11] & 2047) << 25;
	des[4] = (src[11] & 2047) >> 7;
	des[4] |= (src[12] & 2047) << 4;
	des[4] |= (src[13] & 2047) << 15;
	des[4] |= (src[14] & 2047) << 26;
	des[5] = (src[14] & 2047) >> 6;
	des[5] |= (src[15] & 2047) << 5;
	des[5] |= (src[16] & 2047) << 16;
	des[5] |= (src[17] & 2047) << 27;
	des[6] = (src[17] & 2047) >> 5;
	des[6] |= (src[18] & 2047) << 6;
	des[6] |= (src[19] & 2047) << 17;
	des[6] |= (src[20] & 2047) << 28;
	des[7] = (src[20] & 2047) >> 4;
	des[7] |= (src[21] & 2047) << 7;
	des[7] |= (src[22] & 2047) << 18;
	des[7] |= (src[23] & 2047) << 29;
	des[8] = (src[23] & 2047) >> 3;
	des[8] |= (src[24] & 2047) << 8;
	des[8] |= (src[25] & 2047) << 19;
	des[8] |= (src[26] & 2047) << 30;
	des[9] = (src[26] & 2047) >> 2;
	des[9] |= (src[27] & 2047) << 9;
	des[9] |= (src[28] & 2047) << 20;
	des[9] |= (src[29] & 2047) << 31;
	des[10] = (src[29] & 2047) >> 1;
	des[10] |= (src[30] & 2047) << 10;
	des[10] |= (src[31] & 2047) << 21;
}

template<typename T>
void AFOR_pack_32_12(uint32_t * des, const T *src) {
	des[0] = (src[0] & 4095);
	des[0] |= (src[1] & 4095) << 12;
	des[0] |= (src[2] & 4095) << 24;
	des[1] = (src[2] & 4095) >> 8;
	des[1] |= (src[3] & 4095) << 4;
	des[1] |= (src[4] & 4095) << 16;
	des[1] |= (src[5] & 4095) << 28;
	des[2] = (src[5] & 4095) >> 4;
	des[2] |= (src[6] & 4095) << 8;
	des[2] |= (src[7] & 4095) << 20;
	des[3] = (src[8] & 4095);
	des[3] |= (src[9] & 4095) << 12;
	des[3] |= (src[10] & 4095) << 24;
	des[4] = (src[10] & 4095) >> 8;
	des[4] |= (src[11] & 4095) << 4;
	des[4] |= (src[12] & 4095) << 16;
	des[4] |= (src[13] & 4095) << 28;
	des[5] = (src[13] & 4095) >> 4;
	des[5] |= (src[14] & 4095) << 8;
	des[5] |= (src[15] & 4095) << 20;
	des[6] = (src[16] & 4095);
	des[6] |= (src[17] & 4095) << 12;
	des[6] |= (src[18] & 4095) << 24;
	des[7] = (src[18] & 4095) >> 8;
	des[7] |= (src[19] & 4095) << 4;
	des[7] |= (src[20] & 4095) << 16;
	des[7] |= (src[21] & 4095) << 28;
	des[8] = (src[21] & 4095) >> 4;
	des[8] |= (src[22] & 4095) << 8;
	des[8] |= (src[23] & 4095) << 20;
	des[9] = (src[24] & 4095);
	des[9] |= (src[25] & 4095) << 12;
	des[9] |= (src[26] & 4095) << 24;
	des[10] = (src[26] & 4095) >> 8;
	des[10] |= (src[27] & 4095) << 4;
	des[10] |= (src[28] & 4095) << 16;
	des[10] |= (src[29] & 4095) << 28;
	des[11] = (src[29] & 4095) >> 4;
	des[11] |= (src[30] & 4095) << 8;
	des[11] |= (src[31] & 4095) << 20;
}

template<typename T>
void AFOR_pack_32_13(uint32_t * des, const T *src) {
	des[0] = (src[0] & 8191);
	des[0] |= (src[1] & 8191) << 13;
	des[0] |= (src[2] & 8191) << 26;
	des[1] = (src[2] & 8191) >> 6;
	des[1] |= (src[3] & 8191) << 7;
	des[1] |= (src[4] & 8191) << 20;
	des[2] = (src[4] & 8191) >> 12;
	des[2] |= (src[5] & 8191) << 1;
	des[2] |= (src[6] & 8191) << 14;
	des[2] |= (src[7] & 8191) << 27;
	des[3] = (src[7] & 8191) >> 5;
	des[3] |= (src[8] & 8191) << 8;
	des[3] |= (src[9] & 8191) << 21;
	des[4] = (src[9] & 8191) >> 11;
	des[4] |= (src[10] & 8191) << 2;
	des[4] |= (src[11] & 8191) << 15;
	des[4] |= (src[12] & 8191) << 28;
	des[5] = (src[12] & 8191) >> 4;
	des[5] |= (src[13] & 8191) << 9;
	des[5] |= (src[14] & 8191) << 22;
	des[6] = (src[14] & 8191) >> 10;
	des[6] |= (src[15] & 8191) << 3;
	des[6] |= (src[16] & 8191) << 16;
	des[6] |= (src[17] & 8191) << 29;
	des[7] = (src[17] & 8191) >> 3;
	des[7] |= (src[18] & 8191) << 10;
	des[7] |= (src[19] & 8191) << 23;
	des[8] = (src[19] & 8191) >> 9;
	des[8] |= (src[20] & 8191) << 4;
	des[8] |= (src[21] & 8191) << 17;
	des[8] |= (src[22] & 8191) << 30;
	des[9] = (src[22] & 8191) >> 2;
	des[9] |= (src[23] & 8191) << 11;
	des[9] |= (src[24] & 8191) << 24;
	des[10] = (src[24] & 8191) >> 8;
	des[10] |= (src[25] & 8191) << 5;
	des[10] |= (src[26] & 8191) << 18;
	des[10] |= (src[27] & 8191) << 31;
	des[11] = (src[27] & 8191) >> 1;
	des[11] |= (src[28] & 8191) << 12;
	des[11] |= (src[29] & 8191) << 25;
	des[12] = (src[29] & 8191) >> 7;
	des[12] |= (src[30] & 8191) << 6;
	des[12] |= (src[31] & 8191) << 19;
}

template<typename T>
void AFOR_pack_32_14(uint32_t * des, const T *src) {
	des[0] = (src[0] & 16383);
	des[0] |= (src[1] & 16383) << 14;
	des[0] |= (src[2] & 16383) << 28;
	des[1] = (src[2] & 16383) >> 4;
	des[1] |= (src[3] & 16383) << 10;
	des[1] |= (src[4] & 16383) << 24;
	des[2] = (src[4] & 16383) >> 8;
	des[2] |= (src[5] & 16383) << 6;
	des[2] |= (src[6] & 16383) << 20;
	des[3] = (src[6] & 16383) >> 12;
	des[3] |= (src[7] & 16383) << 2;
	des[3] |= (src[8] & 16383) << 16;
	des[3] |= (src[9] & 16383) << 30;
	des[4] = (src[9] & 16383) >> 2;
	des[4] |= (src[10] & 16383) << 12;
	des[4] |= (src[11] & 16383) << 26;
	des[5] = (src[11] & 16383) >> 6;
	des[5] |= (src[12] & 16383) << 8;
	des[5] |= (src[13] & 16383) << 22;
	des[6] = (src[13] & 16383) >> 10;
	des[6] |= (src[14] & 16383) << 4;
	des[6] |= (src[15] & 16383) << 18;
	des[7] = (src[16] & 16383);
	des[7] |= (src[17] & 16383) << 14;
	des[7] |= (src[18] & 16383) << 28;
	des[8] = (src[18] & 16383) >> 4;
	des[8] |= (src[19] & 16383) << 10;
	des[8] |= (src[20] & 16383) << 24;
	des[9] = (src[20] & 16383) >> 8;
	des[9] |= (src[21] & 16383) << 6;
	des[9] |= (src[22] & 16383) << 20;
	des[10] = (src[22] & 16383) >> 12;
	des[10] |= (src[23] & 16383) << 2;
	des[10] |= (src[24] & 16383) << 16;
	des[10] |= (src[25] & 16383) << 30;
	des[11] = (src[25] & 16383) >> 2;
	des[11] |= (src[26] & 16383) << 12;
	des[11] |= (src[27] & 16383) << 26;
	des[12] = (src[27] & 16383) >> 6;
	des[12] |= (src[28] & 16383) << 8;
	des[12] |= (src[29] & 16383) << 22;
	des[13] = (src[29] & 16383) >> 10;
	des[13] |= (src[30] & 16383) << 4;
	des[13] |= (src[31] & 16383) << 18;
}

template<typename T>
void AFOR_pack_32_15(uint32_t * des, const T *src) {
	des[0] = (src[0] & 32767);
	des[0] |= (src[1] & 32767) << 15;
	des[0] |= (src[2] & 32767) << 30;
	des[1] = (src[2] & 32767) >> 2;
	des[1] |= (src[3] & 32767) << 13;
	des[1] |= (src[4] & 32767) << 28;
	des[2] = (src[4] & 32767) >> 4;
	des[2] |= (src[5] & 32767) << 11;
	des[2] |= (src[6] & 32767) << 26;
	des[3] = (src[6] & 32767) >> 6;
	des[3] |= (src[7] & 32767) << 9;
	des[3] |= (src[8] & 32767) << 24;
	des[4] = (src[8] & 32767) >> 8;
	des[4] |= (src[9] & 32767) << 7;
	des[4] |= (src[10] & 32767) << 22;
	des[5] = (src[10] & 32767) >> 10;
	des[5] |= (src[11] & 32767) << 5;
	des[5] |= (src[12] & 32767) << 20;
	des[6] = (src[12] & 32767) >> 12;
	des[6] |= (src[13] & 32767) << 3;
	des[6] |= (src[14] & 32767) << 18;
	des[7] = (src[14] & 32767) >> 14;
	des[7] |= (src[15] & 32767) << 1;
	des[7] |= (src[16] & 32767) << 16;
	des[7] |= (src[17] & 32767) << 31;
	des[8] = (src[17] & 32767) >> 1;
	des[8] |= (src[18] & 32767) << 14;
	des[8] |= (src[19] & 32767) << 29;
	des[9] = (src[19] & 32767) >> 3;
	des[9] |= (src[20] & 32767) << 12;
	des[9] |= (src[21] & 32767) << 27;
	des[10] = (src[21] & 32767) >> 5;
	des[10] |= (src[22] & 32767) << 10;
	des[10] |= (src[23] & 32767) << 25;
	des[11] = (src[23] & 32767) >> 7;
	des[11] |= (src[24] & 32767) << 8;
	des[11] |= (src[25] & 32767) << 23;
	des[12] = (src[25] & 32767) >> 9;
	des[12] |= (src[26] & 32767) << 6;
	des[12] |= (src[27] & 32767) << 21;
	des[13] = (src[27] & 32767) >> 11;
	des[13] |= (src[28] & 32767) << 4;
	des[13] |= (src[29] & 32767) << 19;
	des[14] = (src[29] & 32767) >> 13;
	des[14] |= (src[30] & 32767) << 2;
	des[14] |= (src[31] & 32767) << 17;
}

template<typename T>
void AFOR_pack_32_16(uint32_t * des, const T *src) {
	des[0] = (src[0] & 65535);
	des[0] |= (src[1] & 65535) << 16;
	des[1] = (src[2] & 65535);
	des[1] |= (src[3] & 65535) << 16;
	des[2] = (src[4] & 65535);
	des[2] |= (src[5] & 65535) << 16;
	des[3] = (src[6] & 65535);
	des[3] |= (src[7] & 65535) << 16;
	des[4] = (src[8] & 65535);
	des[4] |= (src[9] & 65535) << 16;
	des[5] = (src[10] & 65535);
	des[5] |= (src[11] & 65535) << 16;
	des[6] = (src[12] & 65535);
	des[6] |= (src[13] & 65535) << 16;
	des[7] = (src[14] & 65535);
	des[7] |= (src[15] & 65535) << 16;
	des[8] = (src[16] & 65535);
	des[8] |= (src[17] & 65535) << 16;
	des[9] = (src[18] & 65535);
	des[9] |= (src[19] & 65535) << 16;
	des[10] = (src[20] & 65535);
	des[10] |= (src[21] & 65535) << 16;
	des[11] = (src[22] & 65535);
	des[11] |= (src[23] & 65535) << 16;
	des[12] = (src[24] & 65535);
	des[12] |= (src[25] & 65535) << 16;
	des[13] = (src[26] & 65535);
	des[13] |= (src[27] & 65535) << 16;
	des[14] = (src[28] & 65535);
	des[14] |= (src[29] & 65535) << 16;
	des[15] = (src[30] & 65535);
	des[15] |= (src[31] & 65535) << 16;
}

template<typename T>
void AFOR_pack_32_17(uint32_t * des, const T *src) {
	des[0] = (src[0] & 131071);
	des[0] |= (src[1] & 131071) << 17;
	des[1] = (src[1] & 131071) >> 15;
	des[1] |= (src[2] & 131071) << 2;
	des[1] |= (src[3] & 131071) << 19;
	des[2] = (src[3] & 131071) >> 13;
	des[2] |= (src[4] & 131071) << 4;
	des[2] |= (src[5] & 131071) << 21;
	des[3] = (src[5] & 131071) >> 11;
	des[3] |= (src[6] & 131071) << 6;
	des[3] |= (src[7] & 131071) << 23;
	des[4] = (src[7] & 131071) >> 9;
	des[4] |= (src[8] & 131071) << 8;
	des[4] |= (src[9] & 131071) << 25;
	des[5] = (src[9] & 131071) >> 7;
	des[5] |= (src[10] & 131071) << 10;
	des[5] |= (src[11] & 131071) << 27;
	des[6] = (src[11] & 131071) >> 5;
	des[6] |= (src[12] & 131071) << 12;
	des[6] |= (src[13] & 131071) << 29;
	des[7] = (src[13] & 131071) >> 3;
	des[7] |= (src[14] & 131071) << 14;
	des[7] |= (src[15] & 131071) << 31;
	des[8] = (src[15] & 131071) >> 1;
	des[8] |= (src[16] & 131071) << 16;
	des[9] = (src[16] & 131071) >> 16;
	des[9] |= (src[17] & 131071) << 1;
	des[9] |= (src[18] & 131071) << 18;
	des[10] = (src[18] & 131071) >> 14;
	des[10] |= (src[19] & 131071) << 3;
	des[10] |= (src[20] & 131071) << 20;
	des[11] = (src[20] & 131071) >> 12;
	des[11] |= (src[21] & 131071) << 5;
	des[11] |= (src[22] & 131071) << 22;
	des[12] = (src[22] & 131071) >> 10;
	des[12] |= (src[23] & 131071) << 7;
	des[12] |= (src[24] & 131071) << 24;
	des[13] = (src[24] & 131071) >> 8;
	des[13] |= (src[25] & 131071) << 9;
	des[13] |= (src[26] & 131071) << 26;
	des[14] = (src[26] & 131071) >> 6;
	des[14] |= (src[27] & 131071) << 11;
	des[14] |= (src[28] & 131071) << 28;
	des[15] = (src[28] & 131071) >> 4;
	des[15] |= (src[29] & 131071) << 13;
	des[15] |= (src[30] & 131071) << 30;
	des[16] = (src[30] & 131071) >> 2;
	des[16] |= (src[31] & 131071) << 15;
}

template<typename T>
void AFOR_pack_32_18(uint32_t * des, const T *src) {
	des[0] = (src[0] & 262143);
	des[0] |= (src[1] & 262143) << 18;
	des[1] = (src[1] & 262143) >> 14;
	des[1] |= (src[2] & 262143) << 4;
	des[1] |= (src[3] & 262143) << 22;
	des[2] = (src[3] & 262143) >> 10;
	des[2] |= (src[4] & 262143) << 8;
	des[2] |= (src[5] & 262143) << 26;
	des[3] = (src[5] & 262143) >> 6;
	des[3] |= (src[6] & 262143) << 12;
	des[3] |= (src[7] & 262143) << 30;
	des[4] = (src[7] & 262143) >> 2;
	des[4] |= (src[8] & 262143) << 16;
	des[5] = (src[8] & 262143) >> 16;
	des[5] |= (src[9] & 262143) << 2;
	des[5] |= (src[10] & 262143) << 20;
	des[6] = (src[10] & 262143) >> 12;
	des[6] |= (src[11] & 262143) << 6;
	des[6] |= (src[12] & 262143) << 24;
	des[7] = (src[12] & 262143) >> 8;
	des[7] |= (src[13] & 262143) << 10;
	des[7] |= (src[14] & 262143) << 28;
	des[8] = (src[14] & 262143) >> 4;
	des[8] |= (src[15] & 262143) << 14;
	des[9] = (src[16] & 262143);
	des[9] |= (src[17] & 262143) << 18;
	des[10] = (src[17] & 262143) >> 14;
	des[10] |= (src[18] & 262143) << 4;
	des[10] |= (src[19] & 262143) << 22;
	des[11] = (src[19] & 262143) >> 10;
	des[11] |= (src[20] & 262143) << 8;
	des[11] |= (src[21] & 262143) << 26;
	des[12] = (src[21] & 262143) >> 6;
	des[12] |= (src[22] & 262143) << 12;
	des[12] |= (src[23] & 262143) << 30;
	des[13] = (src[23] & 262143) >> 2;
	des[13] |= (src[24] & 262143) << 16;
	des[14] = (src[24] & 262143) >> 16;
	des[14] |= (src[25] & 262143) << 2;
	des[14] |= (src[26] & 262143) << 20;
	des[15] = (src[26] & 262143) >> 12;
	des[15] |= (src[27] & 262143) << 6;
	des[15] |= (src[28] & 262143) << 24;
	des[16] = (src[28] & 262143) >> 8;
	des[16] |= (src[29] & 262143) << 10;
	des[16] |= (src[30] & 262143) << 28;
	des[17] = (src[30] & 262143) >> 4;
	des[17] |= (src[31] & 262143) << 14;
}

template<typename T>
void AFOR_pack_32_19(uint32_t * des, const T *src) {
	des[0] = (src[0] & 524287);
	des[0] |= (src[1] & 524287) << 19;
	des[1] = (src[1] & 524287) >> 13;
	des[1] |= (src[2] & 524287) << 6;
	des[1] |= (src[3] & 524287) << 25;
	des[2] = (src[3] & 524287) >> 7;
	des[2] |= (src[4] & 524287) << 12;
	des[2] |= (src[5] & 524287) << 31;
	des[3] = (src[5] & 524287) >> 1;
	des[3] |= (src[6] & 524287) << 18;
	des[4] = (src[6] & 524287) >> 14;
	des[4] |= (src[7] & 524287) << 5;
	des[4] |= (src[8] & 524287) << 24;
	des[5] = (src[8] & 524287) >> 8;
	des[5] |= (src[9] & 524287) << 11;
	des[5] |= (src[10] & 524287) << 30;
	des[6] = (src[10] & 524287) >> 2;
	des[6] |= (src[11] & 524287) << 17;
	des[7] = (src[11] & 524287) >> 15;
	des[7] |= (src[12] & 524287) << 4;
	des[7] |= (src[13] & 524287) << 23;
	des[8] = (src[13] & 524287) >> 9;
	des[8] |= (src[14] & 524287) << 10;
	des[8] |= (src[15] & 524287) << 29;
	des[9] = (src[15] & 524287) >> 3;
	des[9] |= (src[16] & 524287) << 16;
	des[10] = (src[16] & 524287) >> 16;
	des[10] |= (src[17] & 524287) << 3;
	des[10] |= (src[18] & 524287) << 22;
	des[11] = (src[18] & 524287) >> 10;
	des[11] |= (src[19] & 524287) << 9;
	des[11] |= (src[20] & 524287) << 28;
	des[12] = (src[20] & 524287) >> 4;
	des[12] |= (src[21] & 524287) << 15;
	des[13] = (src[21] & 524287) >> 17;
	des[13] |= (src[22] & 524287) << 2;
	des[13] |= (src[23] & 524287) << 21;
	des[14] = (src[23] & 524287) >> 11;
	des[14] |= (src[24] & 524287) << 8;
	des[14] |= (src[25] & 524287) << 27;
	des[15] = (src[25] & 524287) >> 5;
	des[15] |= (src[26] & 524287) << 14;
	des[16] = (src[26] & 524287) >> 18;
	des[16] |= (src[27] & 524287) << 1;
	des[16] |= (src[28] & 524287) << 20;
	des[17] = (src[28] & 524287) >> 12;
	des[17] |= (src[29] & 524287) << 7;
	des[17] |= (src[30] & 524287) << 26;
	des[18] = (src[30] & 524287) >> 6;
	des[18] |= (src[31] & 524287) << 13;
}

template<typename T>
void AFOR_pack_32_20(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1048575);
	des[0] |= (src[1] & 1048575) << 20;
	des[1] = (src[1] & 1048575) >> 12;
	des[1] |= (src[2] & 1048575) << 8;
	des[1] |= (src[3] & 1048575) << 28;
	des[2] = (src[3] & 1048575) >> 4;
	des[2] |= (src[4] & 1048575) << 16;
	des[3] = (src[4] & 1048575) >> 16;
	des[3] |= (src[5] & 1048575) << 4;
	des[3] |= (src[6] & 1048575) << 24;
	des[4] = (src[6] & 1048575) >> 8;
	des[4] |= (src[7] & 1048575) << 12;
	des[5] = (src[8] & 1048575);
	des[5] |= (src[9] & 1048575) << 20;
	des[6] = (src[9] & 1048575) >> 12;
	des[6] |= (src[10] & 1048575) << 8;
	des[6] |= (src[11] & 1048575) << 28;
	des[7] = (src[11] & 1048575) >> 4;
	des[7] |= (src[12] & 1048575) << 16;
	des[8] = (src[12] & 1048575) >> 16;
	des[8] |= (src[13] & 1048575) << 4;
	des[8] |= (src[14] & 1048575) << 24;
	des[9] = (src[14] & 1048575) >> 8;
	des[9] |= (src[15] & 1048575) << 12;
	des[10] = (src[16] & 1048575);
	des[10] |= (src[17] & 1048575) << 20;
	des[11] = (src[17] & 1048575) >> 12;
	des[11] |= (src[18] & 1048575) << 8;
	des[11] |= (src[19] & 1048575) << 28;
	des[12] = (src[19] & 1048575) >> 4;
	des[12] |= (src[20] & 1048575) << 16;
	des[13] = (src[20] & 1048575) >> 16;
	des[13] |= (src[21] & 1048575) << 4;
	des[13] |= (src[22] & 1048575) << 24;
	des[14] = (src[22] & 1048575) >> 8;
	des[14] |= (src[23] & 1048575) << 12;
	des[15] = (src[24] & 1048575);
	des[15] |= (src[25] & 1048575) << 20;
	des[16] = (src[25] & 1048575) >> 12;
	des[16] |= (src[26] & 1048575) << 8;
	des[16] |= (src[27] & 1048575) << 28;
	des[17] = (src[27] & 1048575) >> 4;
	des[17] |= (src[28] & 1048575) << 16;
	des[18] = (src[28] & 1048575) >> 16;
	des[18] |= (src[29] & 1048575) << 4;
	des[18] |= (src[30] & 1048575) << 24;
	des[19] = (src[30] & 1048575) >> 8;
	des[19] |= (src[31] & 1048575) << 12;
}

template<typename T>
void AFOR_pack_32_21(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2097151);
	des[0] |= (src[1] & 2097151) << 21;
	des[1] = (src[1] & 2097151) >> 11;
	des[1] |= (src[2] & 2097151) << 10;
	des[1] |= (src[3] & 2097151) << 31;
	des[2] = (src[3] & 2097151) >> 1;
	des[2] |= (src[4] & 2097151) << 20;
	des[3] = (src[4] & 2097151) >> 12;
	des[3] |= (src[5] & 2097151) << 9;
	des[3] |= (src[6] & 2097151) << 30;
	des[4] = (src[6] & 2097151) >> 2;
	des[4] |= (src[7] & 2097151) << 19;
	des[5] = (src[7] & 2097151) >> 13;
	des[5] |= (src[8] & 2097151) << 8;
	des[5] |= (src[9] & 2097151) << 29;
	des[6] = (src[9] & 2097151) >> 3;
	des[6] |= (src[10] & 2097151) << 18;
	des[7] = (src[10] & 2097151) >> 14;
	des[7] |= (src[11] & 2097151) << 7;
	des[7] |= (src[12] & 2097151) << 28;
	des[8] = (src[12] & 2097151) >> 4;
	des[8] |= (src[13] & 2097151) << 17;
	des[9] = (src[13] & 2097151) >> 15;
	des[9] |= (src[14] & 2097151) << 6;
	des[9] |= (src[15] & 2097151) << 27;
	des[10] = (src[15] & 2097151) >> 5;
	des[10] |= (src[16] & 2097151) << 16;
	des[11] = (src[16] & 2097151) >> 16;
	des[11] |= (src[17] & 2097151) << 5;
	des[11] |= (src[18] & 2097151) << 26;
	des[12] = (src[18] & 2097151) >> 6;
	des[12] |= (src[19] & 2097151) << 15;
	des[13] = (src[19] & 2097151) >> 17;
	des[13] |= (src[20] & 2097151) << 4;
	des[13] |= (src[21] & 2097151) << 25;
	des[14] = (src[21] & 2097151) >> 7;
	des[14] |= (src[22] & 2097151) << 14;
	des[15] = (src[22] & 2097151) >> 18;
	des[15] |= (src[23] & 2097151) << 3;
	des[15] |= (src[24] & 2097151) << 24;
	des[16] = (src[24] & 2097151) >> 8;
	des[16] |= (src[25] & 2097151) << 13;
	des[17] = (src[25] & 2097151) >> 19;
	des[17] |= (src[26] & 2097151) << 2;
	des[17] |= (src[27] & 2097151) << 23;
	des[18] = (src[27] & 2097151) >> 9;
	des[18] |= (src[28] & 2097151) << 12;
	des[19] = (src[28] & 2097151) >> 20;
	des[19] |= (src[29] & 2097151) << 1;
	des[19] |= (src[30] & 2097151) << 22;
	des[20] = (src[30] & 2097151) >> 10;
	des[20] |= (src[31] & 2097151) << 11;
}

template<typename T>
void AFOR_pack_32_22(uint32_t * des, const T *src) {
	des[0] = (src[0] & 4194303);
	des[0] |= (src[1] & 4194303) << 22;
	des[1] = (src[1] & 4194303) >> 10;
	des[1] |= (src[2] & 4194303) << 12;
	des[2] = (src[2] & 4194303) >> 20;
	des[2] |= (src[3] & 4194303) << 2;
	des[2] |= (src[4] & 4194303) << 24;
	des[3] = (src[4] & 4194303) >> 8;
	des[3] |= (src[5] & 4194303) << 14;
	des[4] = (src[5] & 4194303) >> 18;
	des[4] |= (src[6] & 4194303) << 4;
	des[4] |= (src[7] & 4194303) << 26;
	des[5] = (src[7] & 4194303) >> 6;
	des[5] |= (src[8] & 4194303) << 16;
	des[6] = (src[8] & 4194303) >> 16;
	des[6] |= (src[9] & 4194303) << 6;
	des[6] |= (src[10] & 4194303) << 28;
	des[7] = (src[10] & 4194303) >> 4;
	des[7] |= (src[11] & 4194303) << 18;
	des[8] = (src[11] & 4194303) >> 14;
	des[8] |= (src[12] & 4194303) << 8;
	des[8] |= (src[13] & 4194303) << 30;
	des[9] = (src[13] & 4194303) >> 2;
	des[9] |= (src[14] & 4194303) << 20;
	des[10] = (src[14] & 4194303) >> 12;
	des[10] |= (src[15] & 4194303) << 10;
	des[11] = (src[16] & 4194303);
	des[11] |= (src[17] & 4194303) << 22;
	des[12] = (src[17] & 4194303) >> 10;
	des[12] |= (src[18] & 4194303) << 12;
	des[13] = (src[18] & 4194303) >> 20;
	des[13] |= (src[19] & 4194303) << 2;
	des[13] |= (src[20] & 4194303) << 24;
	des[14] = (src[20] & 4194303) >> 8;
	des[14] |= (src[21] & 4194303) << 14;
	des[15] = (src[21] & 4194303) >> 18;
	des[15] |= (src[22] & 4194303) << 4;
	des[15] |= (src[23] & 4194303) << 26;
	des[16] = (src[23] & 4194303) >> 6;
	des[16] |= (src[24] & 4194303) << 16;
	des[17] = (src[24] & 4194303) >> 16;
	des[17] |= (src[25] & 4194303) << 6;
	des[17] |= (src[26] & 4194303) << 28;
	des[18] = (src[26] & 4194303) >> 4;
	des[18] |= (src[27] & 4194303) << 18;
	des[19] = (src[27] & 4194303) >> 14;
	des[19] |= (src[28] & 4194303) << 8;
	des[19] |= (src[29] & 4194303) << 30;
	des[20] = (src[29] & 4194303) >> 2;
	des[20] |= (src[30] & 4194303) << 20;
	des[21] = (src[30] & 4194303) >> 12;
	des[21] |= (src[31] & 4194303) << 10;
}

template<typename T>
void AFOR_pack_32_23(uint32_t * des, const T *src) {
	des[0] = (src[0] & 8388607);
	des[0] |= (src[1] & 8388607) << 23;
	des[1] = (src[1] & 8388607) >> 9;
	des[1] |= (src[2] & 8388607) << 14;
	des[2] = (src[2] & 8388607) >> 18;
	des[2] |= (src[3] & 8388607) << 5;
	des[2] |= (src[4] & 8388607) << 28;
	des[3] = (src[4] & 8388607) >> 4;
	des[3] |= (src[5] & 8388607) << 19;
	des[4] = (src[5] & 8388607) >> 13;
	des[4] |= (src[6] & 8388607) << 10;
	des[5] = (src[6] & 8388607) >> 22;
	des[5] |= (src[7] & 8388607) << 1;
	des[5] |= (src[8] & 8388607) << 24;
	des[6] = (src[8] & 8388607) >> 8;
	des[6] |= (src[9] & 8388607) << 15;
	des[7] = (src[9] & 8388607) >> 17;
	des[7] |= (src[10] & 8388607) << 6;
	des[7] |= (src[11] & 8388607) << 29;
	des[8] = (src[11] & 8388607) >> 3;
	des[8] |= (src[12] & 8388607) << 20;
	des[9] = (src[12] & 8388607) >> 12;
	des[9] |= (src[13] & 8388607) << 11;
	des[10] = (src[13] & 8388607) >> 21;
	des[10] |= (src[14] & 8388607) << 2;
	des[10] |= (src[15] & 8388607) << 25;
	des[11] = (src[15] & 8388607) >> 7;
	des[11] |= (src[16] & 8388607) << 16;
	des[12] = (src[16] & 8388607) >> 16;
	des[12] |= (src[17] & 8388607) << 7;
	des[12] |= (src[18] & 8388607) << 30;
	des[13] = (src[18] & 8388607) >> 2;
	des[13] |= (src[19] & 8388607) << 21;
	des[14] = (src[19] & 8388607) >> 11;
	des[14] |= (src[20] & 8388607) << 12;
	des[15] = (src[20] & 8388607) >> 20;
	des[15] |= (src[21] & 8388607) << 3;
	des[15] |= (src[22] & 8388607) << 26;
	des[16] = (src[22] & 8388607) >> 6;
	des[16] |= (src[23] & 8388607) << 17;
	des[17] = (src[23] & 8388607) >> 15;
	des[17] |= (src[24] & 8388607) << 8;
	des[17] |= (src[25] & 8388607) << 31;
	des[18] = (src[25] & 8388607) >> 1;
	des[18] |= (src[26] & 8388607) << 22;
	des[19] = (src[26] & 8388607) >> 10;
	des[19] |= (src[27] & 8388607) << 13;
	des[20] = (src[27] & 8388607) >> 19;
	des[20] |= (src[28] & 8388607) << 4;
	des[20] |= (src[29] & 8388607) << 27;
	des[21] = (src[29] & 8388607) >> 5;
	des[21] |= (src[30] & 8388607) << 18;
	des[22] = (src[30] & 8388607) >> 14;
	des[22] |= (src[31] & 8388607) << 9;
}

template<typename T>
void AFOR_pack_32_24(uint32_t * des, const T *src) {
	des[0] = (src[0] & 16777215);
	des[0] |= (src[1] & 16777215) << 24;
	des[1] = (src[1] & 16777215) >> 8;
	des[1] |= (src[2] & 16777215) << 16;
	des[2] = (src[2] & 16777215) >> 16;
	des[2] |= (src[3] & 16777215) << 8;
	des[3] = (src[4] & 16777215);
	des[3] |= (src[5] & 16777215) << 24;
	des[4] = (src[5] & 16777215) >> 8;
	des[4] |= (src[6] & 16777215) << 16;
	des[5] = (src[6] & 16777215) >> 16;
	des[5] |= (src[7] & 16777215) << 8;
	des[6] = (src[8] & 16777215);
	des[6] |= (src[9] & 16777215) << 24;
	des[7] = (src[9] & 16777215) >> 8;
	des[7] |= (src[10] & 16777215) << 16;
	des[8] = (src[10] & 16777215) >> 16;
	des[8] |= (src[11] & 16777215) << 8;
	des[9] = (src[12] & 16777215);
	des[9] |= (src[13] & 16777215) << 24;
	des[10] = (src[13] & 16777215) >> 8;
	des[10] |= (src[14] & 16777215) << 16;
	des[11] = (src[14] & 16777215) >> 16;
	des[11] |= (src[15] & 16777215) << 8;
	des[12] = (src[16] & 16777215);
	des[12] |= (src[17] & 16777215) << 24;
	des[13] = (src[17] & 16777215) >> 8;
	des[13] |= (src[18] & 16777215) << 16;
	des[14] = (src[18] & 16777215) >> 16;
	des[14] |= (src[19] & 16777215) << 8;
	des[15] = (src[20] & 16777215);
	des[15] |= (src[21] & 16777215) << 24;
	des[16] = (src[21] & 16777215) >> 8;
	des[16] |= (src[22] & 16777215) << 16;
	des[17] = (src[22] & 16777215) >> 16;
	des[17] |= (src[23] & 16777215) << 8;
	des[18] = (src[24] & 16777215);
	des[18] |= (src[25] & 16777215) << 24;
	des[19] = (src[25] & 16777215) >> 8;
	des[19] |= (src[26] & 16777215) << 16;
	des[20] = (src[26] & 16777215) >> 16;
	des[20] |= (src[27] & 16777215) << 8;
	des[21] = (src[28] & 16777215);
	des[21] |= (src[29] & 16777215) << 24;
	des[22] = (src[29] & 16777215) >> 8;
	des[22] |= (src[30] & 16777215) << 16;
	des[23] = (src[30] & 16777215) >> 16;
	des[23] |= (src[31] & 16777215) << 8;
}

template<typename T>
void AFOR_pack_32_25(uint32_t * des, const T *src) {
	des[0] = (src[0] & 33554431);
	des[0] |= (src[1] & 33554431) << 25;
	des[1] = (src[1] & 33554431) >> 7;
	des[1] |= (src[2] & 33554431) << 18;
	des[2] = (src[2] & 33554431) >> 14;
	des[2] |= (src[3] & 33554431) << 11;
	des[3] = (src[3] & 33554431) >> 21;
	des[3] |= (src[4] & 33554431) << 4;
	des[3] |= (src[5] & 33554431) << 29;
	des[4] = (src[5] & 33554431) >> 3;
	des[4] |= (src[6] & 33554431) << 22;
	des[5] = (src[6] & 33554431) >> 10;
	des[5] |= (src[7] & 33554431) << 15;
	des[6] = (src[7] & 33554431) >> 17;
	des[6] |= (src[8] & 33554431) << 8;
	des[7] = (src[8] & 33554431) >> 24;
	des[7] |= (src[9] & 33554431) << 1;
	des[7] |= (src[10] & 33554431) << 26;
	des[8] = (src[10] & 33554431) >> 6;
	des[8] |= (src[11] & 33554431) << 19;
	des[9] = (src[11] & 33554431) >> 13;
	des[9] |= (src[12] & 33554431) << 12;
	des[10] = (src[12] & 33554431) >> 20;
	des[10] |= (src[13] & 33554431) << 5;
	des[10] |= (src[14] & 33554431) << 30;
	des[11] = (src[14] & 33554431) >> 2;
	des[11] |= (src[15] & 33554431) << 23;
	des[12] = (src[15] & 33554431) >> 9;
	des[12] |= (src[16] & 33554431) << 16;
	des[13] = (src[16] & 33554431) >> 16;
	des[13] |= (src[17] & 33554431) << 9;
	des[14] = (src[17] & 33554431) >> 23;
	des[14] |= (src[18] & 33554431) << 2;
	des[14] |= (src[19] & 33554431) << 27;
	des[15] = (src[19] & 33554431) >> 5;
	des[15] |= (src[20] & 33554431) << 20;
	des[16] = (src[20] & 33554431) >> 12;
	des[16] |= (src[21] & 33554431) << 13;
	des[17] = (src[21] & 33554431) >> 19;
	des[17] |= (src[22] & 33554431) << 6;
	des[17] |= (src[23] & 33554431) << 31;
	des[18] = (src[23] & 33554431) >> 1;
	des[18] |= (src[24] & 33554431) << 24;
	des[19] = (src[24] & 33554431) >> 8;
	des[19] |= (src[25] & 33554431) << 17;
	des[20] = (src[25] & 33554431) >> 15;
	des[20] |= (src[26] & 33554431) << 10;
	des[21] = (src[26] & 33554431) >> 22;
	des[21] |= (src[27] & 33554431) << 3;
	des[21] |= (src[28] & 33554431) << 28;
	des[22] = (src[28] & 33554431) >> 4;
	des[22] |= (src[29] & 33554431) << 21;
	des[23] = (src[29] & 33554431) >> 11;
	des[23] |= (src[30] & 33554431) << 14;
	des[24] = (src[30] & 33554431) >> 18;
	des[24] |= (src[31] & 33554431) << 7;
}

template<typename T>
void AFOR_pack_32_26(uint32_t * des, const T *src) {
	des[0] = (src[0] & 67108863);
	des[0] |= (src[1] & 67108863) << 26;
	des[1] = (src[1] & 67108863) >> 6;
	des[1] |= (src[2] & 67108863) << 20;
	des[2] = (src[2] & 67108863) >> 12;
	des[2] |= (src[3] & 67108863) << 14;
	des[3] = (src[3] & 67108863) >> 18;
	des[3] |= (src[4] & 67108863) << 8;
	des[4] = (src[4] & 67108863) >> 24;
	des[4] |= (src[5] & 67108863) << 2;
	des[4] |= (src[6] & 67108863) << 28;
	des[5] = (src[6] & 67108863) >> 4;
	des[5] |= (src[7] & 67108863) << 22;
	des[6] = (src[7] & 67108863) >> 10;
	des[6] |= (src[8] & 67108863) << 16;
	des[7] = (src[8] & 67108863) >> 16;
	des[7] |= (src[9] & 67108863) << 10;
	des[8] = (src[9] & 67108863) >> 22;
	des[8] |= (src[10] & 67108863) << 4;
	des[8] |= (src[11] & 67108863) << 30;
	des[9] = (src[11] & 67108863) >> 2;
	des[9] |= (src[12] & 67108863) << 24;
	des[10] = (src[12] & 67108863) >> 8;
	des[10] |= (src[13] & 67108863) << 18;
	des[11] = (src[13] & 67108863) >> 14;
	des[11] |= (src[14] & 67108863) << 12;
	des[12] = (src[14] & 67108863) >> 20;
	des[12] |= (src[15] & 67108863) << 6;
	des[13] = (src[16] & 67108863);
	des[13] |= (src[17] & 67108863) << 26;
	des[14] = (src[17] & 67108863) >> 6;
	des[14] |= (src[18] & 67108863) << 20;
	des[15] = (src[18] & 67108863) >> 12;
	des[15] |= (src[19] & 67108863) << 14;
	des[16] = (src[19] & 67108863) >> 18;
	des[16] |= (src[20] & 67108863) << 8;
	des[17] = (src[20] & 67108863) >> 24;
	des[17] |= (src[21] & 67108863) << 2;
	des[17] |= (src[22] & 67108863) << 28;
	des[18] = (src[22] & 67108863) >> 4;
	des[18] |= (src[23] & 67108863) << 22;
	des[19] = (src[23] & 67108863) >> 10;
	des[19] |= (src[24] & 67108863) << 16;
	des[20] = (src[24] & 67108863) >> 16;
	des[20] |= (src[25] & 67108863) << 10;
	des[21] = (src[25] & 67108863) >> 22;
	des[21] |= (src[26] & 67108863) << 4;
	des[21] |= (src[27] & 67108863) << 30;
	des[22] = (src[27] & 67108863) >> 2;
	des[22] |= (src[28] & 67108863) << 24;
	des[23] = (src[28] & 67108863) >> 8;
	des[23] |= (src[29] & 67108863) << 18;
	des[24] = (src[29] & 67108863) >> 14;
	des[24] |= (src[30] & 67108863) << 12;
	des[25] = (src[30] & 67108863) >> 20;
	des[25] |= (src[31] & 67108863) << 6;
}

template<typename T>
void AFOR_pack_32_27(uint32_t * des, const T *src) {
	des[0] = (src[0] & 134217727);
	des[0] |= (src[1] & 134217727) << 27;
	des[1] = (src[1] & 134217727) >> 5;
	des[1] |= (src[2] & 134217727) << 22;
	des[2] = (src[2] & 134217727) >> 10;
	des[2] |= (src[3] & 134217727) << 17;
	des[3] = (src[3] & 134217727) >> 15;
	des[3] |= (src[4] & 134217727) << 12;
	des[4] = (src[4] & 134217727) >> 20;
	des[4] |= (src[5] & 134217727) << 7;
	des[5] = (src[5] & 134217727) >> 25;
	des[5] |= (src[6] & 134217727) << 2;
	des[5] |= (src[7] & 134217727) << 29;
	des[6] = (src[7] & 134217727) >> 3;
	des[6] |= (src[8] & 134217727) << 24;
	des[7] = (src[8] & 134217727) >> 8;
	des[7] |= (src[9] & 134217727) << 19;
	des[8] = (src[9] & 134217727) >> 13;
	des[8] |= (src[10] & 134217727) << 14;
	des[9] = (src[10] & 134217727) >> 18;
	des[9] |= (src[11] & 134217727) << 9;
	des[10] = (src[11] & 134217727) >> 23;
	des[10] |= (src[12] & 134217727) << 4;
	des[10] |= (src[13] & 134217727) << 31;
	des[11] = (src[13] & 134217727) >> 1;
	des[11] |= (src[14] & 134217727) << 26;
	des[12] = (src[14] & 134217727) >> 6;
	des[12] |= (src[15] & 134217727) << 21;
	des[13] = (src[15] & 134217727) >> 11;
	des[13] |= (src[16] & 134217727) << 16;
	des[14] = (src[16] & 134217727) >> 16;
	des[14] |= (src[17] & 134217727) << 11;
	des[15] = (src[17] & 134217727) >> 21;
	des[15] |= (src[18] & 134217727) << 6;
	des[16] = (src[18] & 134217727) >> 26;
	des[16] |= (src[19] & 134217727) << 1;
	des[16] |= (src[20] & 134217727) << 28;
	des[17] = (src[20] & 134217727) >> 4;
	des[17] |= (src[21] & 134217727) << 23;
	des[18] = (src[21] & 134217727) >> 9;
	des[18] |= (src[22] & 134217727) << 18;
	des[19] = (src[22] & 134217727) >> 14;
	des[19] |= (src[23] & 134217727) << 13;
	des[20] = (src[23] & 134217727) >> 19;
	des[20] |= (src[24] & 134217727) << 8;
	des[21] = (src[24] & 134217727) >> 24;
	des[21] |= (src[25] & 134217727) << 3;
	des[21] |= (src[26] & 134217727) << 30;
	des[22] = (src[26] & 134217727) >> 2;
	des[22] |= (src[27] & 134217727) << 25;
	des[23] = (src[27] & 134217727) >> 7;
	des[23] |= (src[28] & 134217727) << 20;
	des[24] = (src[28] & 134217727) >> 12;
	des[24] |= (src[29] & 134217727) << 15;
	des[25] = (src[29] & 134217727) >> 17;
	des[25] |= (src[30] & 134217727) << 10;
	des[26] = (src[30] & 134217727) >> 22;
	des[26] |= (src[31] & 134217727) << 5;
}

template<typename T>
void AFOR_pack_32_28(uint32_t * des, const T *src) {
	des[0] = (src[0] & 268435455);
	des[0] |= (src[1] & 268435455) << 28;
	des[1] = (src[1] & 268435455) >> 4;
	des[1] |= (src[2] & 268435455) << 24;
	des[2] = (src[2] & 268435455) >> 8;
	des[2] |= (src[3] & 268435455) << 20;
	des[3] = (src[3] & 268435455) >> 12;
	des[3] |= (src[4] & 268435455) << 16;
	des[4] = (src[4] & 268435455) >> 16;
	des[4] |= (src[5] & 268435455) << 12;
	des[5] = (src[5] & 268435455) >> 20;
	des[5] |= (src[6] & 268435455) << 8;
	des[6] = (src[6] & 268435455) >> 24;
	des[6] |= (src[7] & 268435455) << 4;
	des[7] = (src[8] & 268435455);
	des[7] |= (src[9] & 268435455) << 28;
	des[8] = (src[9] & 268435455) >> 4;
	des[8] |= (src[10] & 268435455) << 24;
	des[9] = (src[10] & 268435455) >> 8;
	des[9] |= (src[11] & 268435455) << 20;
	des[10] = (src[11] & 268435455) >> 12;
	des[10] |= (src[12] & 268435455) << 16;
	des[11] = (src[12] & 268435455) >> 16;
	des[11] |= (src[13] & 268435455) << 12;
	des[12] = (src[13] & 268435455) >> 20;
	des[12] |= (src[14] & 268435455) << 8;
	des[13] = (src[14] & 268435455) >> 24;
	des[13] |= (src[15] & 268435455) << 4;
	des[14] = (src[16] & 268435455);
	des[14] |= (src[17] & 268435455) << 28;
	des[15] = (src[17] & 268435455) >> 4;
	des[15] |= (src[18] & 268435455) << 24;
	des[16] = (src[18] & 268435455) >> 8;
	des[16] |= (src[19] & 268435455) << 20;
	des[17] = (src[19] & 268435455) >> 12;
	des[17] |= (src[20] & 268435455) << 16;
	des[18] = (src[20] & 268435455) >> 16;
	des[18] |= (src[21] & 268435455) << 12;
	des[19] = (src[21] & 268435455) >> 20;
	des[19] |= (src[22] & 268435455) << 8;
	des[20] = (src[22] & 268435455) >> 24;
	des[20] |= (src[23] & 268435455) << 4;
	des[21] = (src[24] & 268435455);
	des[21] |= (src[25] & 268435455) << 28;
	des[22] = (src[25] & 268435455) >> 4;
	des[22] |= (src[26] & 268435455) << 24;
	des[23] = (src[26] & 268435455) >> 8;
	des[23] |= (src[27] & 268435455) << 20;
	des[24] = (src[27] & 268435455) >> 12;
	des[24] |= (src[28] & 268435455) << 16;
	des[25] = (src[28] & 268435455) >> 16;
	des[25] |= (src[29] & 268435455) << 12;
	des[26] = (src[29] & 268435455) >> 20;
	des[26] |= (src[30] & 268435455) << 8;
	des[27] = (src[30] & 268435455) >> 24;
	des[27] |= (src[31] & 268435455) << 4;
}

template<typename T>
void AFOR_pack_32_29(uint32_t * des, const T *src) {
	des[0] = (src[0] & 536870911);
	des[0] |= (src[1] & 536870911) << 29;
	des[1] = (src[1] & 536870911) >> 3;
	des[1] |= (src[2] & 536870911) << 26;
	des[2] = (src[2] & 536870911) >> 6;
	des[2] |= (src[3] & 536870911) << 23;
	des[3] = (src[3] & 536870911) >> 9;
	des[3] |= (src[4] & 536870911) << 20;
	des[4] = (src[4] & 536870911) >> 12;
	des[4] |= (src[5] & 536870911) << 17;
	des[5] = (src[5] & 536870911) >> 15;
	des[5] |= (src[6] & 536870911) << 14;
	des[6] = (src[6] & 536870911) >> 18;
	des[6] |= (src[7] & 536870911) << 11;
	des[7] = (src[7] & 536870911) >> 21;
	des[7] |= (src[8] & 536870911) << 8;
	des[8] = (src[8] & 536870911) >> 24;
	des[8] |= (src[9] & 536870911) << 5;
	des[9] = (src[9] & 536870911) >> 27;
	des[9] |= (src[10] & 536870911) << 2;
	des[9] |= (src[11] & 536870911) << 31;
	des[10] = (src[11] & 536870911) >> 1;
	des[10] |= (src[12] & 536870911) << 28;
	des[11] = (src[12] & 536870911) >> 4;
	des[11] |= (src[13] & 536870911) << 25;
	des[12] = (src[13] & 536870911) >> 7;
	des[12] |= (src[14] & 536870911) << 22;
	des[13] = (src[14] & 536870911) >> 10;
	des[13] |= (src[15] & 536870911) << 19;
	des[14] = (src[15] & 536870911) >> 13;
	des[14] |= (src[16] & 536870911) << 16;
	des[15] = (src[16] & 536870911) >> 16;
	des[15] |= (src[17] & 536870911) << 13;
	des[16] = (src[17] & 536870911) >> 19;
	des[16] |= (src[18] & 536870911) << 10;
	des[17] = (src[18] & 536870911) >> 22;
	des[17] |= (src[19] & 536870911) << 7;
	des[18] = (src[19] & 536870911) >> 25;
	des[18] |= (src[20] & 536870911) << 4;
	des[19] = (src[20] & 536870911) >> 28;
	des[19] |= (src[21] & 536870911) << 1;
	des[19] |= (src[22] & 536870911) << 30;
	des[20] = (src[22] & 536870911) >> 2;
	des[20] |= (src[23] & 536870911) << 27;
	des[21] = (src[23] & 536870911) >> 5;
	des[21] |= (src[24] & 536870911) << 24;
	des[22] = (src[24] & 536870911) >> 8;
	des[22] |= (src[25] & 536870911) << 21;
	des[23] = (src[25] & 536870911) >> 11;
	des[23] |= (src[26] & 536870911) << 18;
	des[24] = (src[26] & 536870911) >> 14;
	des[24] |= (src[27] & 536870911) << 15;
	des[25] = (src[27] & 536870911) >> 17;
	des[25] |= (src[28] & 536870911) << 12;
	des[26] = (src[28] & 536870911) >> 20;
	des[26] |= (src[29] & 536870911) << 9;
	des[27] = (src[29] & 536870911) >> 23;
	des[27] |= (src[30] & 536870911) << 6;
	des[28] = (src[30] & 536870911) >> 26;
	des[28] |= (src[31] & 536870911) << 3;
}

template<typename T>
void AFOR_pack_32_30(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1073741823);
	des[0] |= (src[1] & 1073741823) << 30;
	des[1] = (src[1] & 1073741823) >> 2;
	des[1] |= (src[2] & 1073741823) << 28;
	des[2] = (src[2] & 1073741823) >> 4;
	des[2] |= (src[3] & 1073741823) << 26;
	des[3] = (src[3] & 1073741823) >> 6;
	des[3] |= (src[4] & 1073741823) << 24;
	des[4] = (src[4] & 1073741823) >> 8;
	des[4] |= (src[5] & 1073741823) << 22;
	des[5] = (src[5] & 1073741823) >> 10;
	des[5] |= (src[6] & 1073741823) << 20;
	des[6] = (src[6] & 1073741823) >> 12;
	des[6] |= (src[7] & 1073741823) << 18;
	des[7] = (src[7] & 1073741823) >> 14;
	des[7] |= (src[8] & 1073741823) << 16;
	des[8] = (src[8] & 1073741823) >> 16;
	des[8] |= (src[9] & 1073741823) << 14;
	des[9] = (src[9] & 1073741823) >> 18;
	des[9] |= (src[10] & 1073741823) << 12;
	des[10] = (src[10] & 1073741823) >> 20;
	des[10] |= (src[11] & 1073741823) << 10;
	des[11] = (src[11] & 1073741823) >> 22;
	des[11] |= (src[12] & 1073741823) << 8;
	des[12] = (src[12] & 1073741823) >> 24;
	des[12] |= (src[13] & 1073741823) << 6;
	des[13] = (src[13] & 1073741823) >> 26;
	des[13] |= (src[14] & 1073741823) << 4;
	des[14] = (src[14] & 1073741823) >> 28;
	des[14] |= (src[15] & 1073741823) << 2;
	des[15] = (src[16] & 1073741823);
	des[15] |= (src[17] & 1073741823) << 30;
	des[16] = (src[17] & 1073741823) >> 2;
	des[16] |= (src[18] & 1073741823) << 28;
	des[17] = (src[18] & 1073741823) >> 4;
	des[17] |= (src[19] & 1073741823) << 26;
	des[18] = (src[19] & 1073741823) >> 6;
	des[18] |= (src[20] & 1073741823) << 24;
	des[19] = (src[20] & 1073741823) >> 8;
	des[19] |= (src[21] & 1073741823) << 22;
	des[20] = (src[21] & 1073741823) >> 10;
	des[20] |= (src[22] & 1073741823) << 20;
	des[21] = (src[22] & 1073741823) >> 12;
	des[21] |= (src[23] & 1073741823) << 18;
	des[22] = (src[23] & 1073741823) >> 14;
	des[22] |= (src[24] & 1073741823) << 16;
	des[23] = (src[24] & 1073741823) >> 16;
	des[23] |= (src[25] & 1073741823) << 14;
	des[24] = (src[25] & 1073741823) >> 18;
	des[24] |= (src[26] & 1073741823) << 12;
	des[25] = (src[26] & 1073741823) >> 20;
	des[25] |= (src[27] & 1073741823) << 10;
	des[26] = (src[27] & 1073741823) >> 22;
	des[26] |= (src[28] & 1073741823) << 8;
	des[27] = (src[28] & 1073741823) >> 24;
	des[27] |= (src[29] & 1073741823) << 6;
	des[28] = (src[29] & 1073741823) >> 26;
	des[28] |= (src[30] & 1073741823) << 4;
	des[29] = (src[30] & 1073741823) >> 28;
	des[29] |= (src[31] & 1073741823) << 2;
}

template<typename T>
void AFOR_pack_32_31(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2147483647);
	des[0] |= (src[1] & 2147483647) << 31;
	des[1] = (src[1] & 2147483647) >> 1;
	des[1] |= (src[2] & 2147483647) << 30;
	des[2] = (src[2] & 2147483647) >> 2;
	des[2] |= (src[3] & 2147483647) << 29;
	des[3] = (src[3] & 2147483647) >> 3;
	des[3] |= (src[4] & 2147483647) << 28;
	des[4] = (src[4] & 2147483647) >> 4;
	des[4] |= (src[5] & 2147483647) << 27;
	des[5] = (src[5] & 2147483647) >> 5;
	des[5] |= (src[6] & 2147483647) << 26;
	des[6] = (src[6] & 2147483647) >> 6;
	des[6] |= (src[7] & 2147483647) << 25;
	des[7] = (src[7] & 2147483647) >> 7;
	des[7] |= (src[8] & 2147483647) << 24;
	des[8] = (src[8] & 2147483647) >> 8;
	des[8] |= (src[9] & 2147483647) << 23;
	des[9] = (src[9] & 2147483647) >> 9;
	des[9] |= (src[10] & 2147483647) << 22;
	des[10] = (src[10] & 2147483647) >> 10;
	des[10] |= (src[11] & 2147483647) << 21;
	des[11] = (src[11] & 2147483647) >> 11;
	des[11] |= (src[12] & 2147483647) << 20;
	des[12] = (src[12] & 2147483647) >> 12;
	des[12] |= (src[13] & 2147483647) << 19;
	des[13] = (src[13] & 2147483647) >> 13;
	des[13] |= (src[14] & 2147483647) << 18;
	des[14] = (src[14] & 2147483647) >> 14;
	des[14] |= (src[15] & 2147483647) << 17;
	des[15] = (src[15] & 2147483647) >> 15;
	des[15] |= (src[16] & 2147483647) << 16;
	des[16] = (src[16] & 2147483647) >> 16;
	des[16] |= (src[17] & 2147483647) << 15;
	des[17] = (src[17] & 2147483647) >> 17;
	des[17] |= (src[18] & 2147483647) << 14;
	des[18] = (src[18] & 2147483647) >> 18;
	des[18] |= (src[19] & 2147483647) << 13;
	des[19] = (src[19] & 2147483647) >> 19;
	des[19] |= (src[20] & 2147483647) << 12;
	des[20] = (src[20] & 2147483647) >> 20;
	des[20] |= (src[21] & 2147483647) << 11;
	des[21] = (src[21] & 2147483647) >> 21;
	des[21] |= (src[22] & 2147483647) << 10;
	des[22] = (src[22] & 2147483647) >> 22;
	des[22] |= (src[23] & 2147483647) << 9;
	des[23] = (src[23] & 2147483647) >> 23;
	des[23] |= (src[24] & 2147483647) << 8;
	des[24] = (src[24] & 2147483647) >> 24;
	des[24] |= (src[25] & 2147483647) << 7;
	des[25] = (src[25] & 2147483647) >> 25;
	des[25] |= (src[26] & 2147483647) << 6;
	des[26] = (src[26] & 2147483647) >> 26;
	des[26] |= (src[27] & 2147483647) << 5;
	des[27] = (src[27] & 2147483647) >> 27;
	des[27] |= (src[28] & 2147483647) << 4;
	des[28] = (src[28] & 2147483647) >> 28;
	des[28] |= (src[29] & 2147483647) << 3;
	des[29] = (src[29] & 2147483647) >> 29;
	des[29] |= (src[30] & 2147483647) << 2;
	des[30] = (src[30] & 2147483647) >> 30;
	des[30] |= (src[31] & 2147483647) << 1;
}

template<typename T>
void AFOR_pack_32_32(uint32_t * des, const T *src) {
	des[0] |= (src[0]);
	des[1] |= (src[1]);
	des[2] |= (src[2]);
	des[3] |= (src[3]);
	des[4] |= (src[4]);
	des[5] |= (src[5]);
	des[6] |= (src[6]);
	des[7] |= (src[7]);
	des[8] |= (src[8]);
	des[9] |= (src[9]);
	des[10] |= (src[10]);
	des[11] |= (src[11]);
	des[12] |= (src[12]);
	des[13] |= (src[13]);
	des[14] |= (src[14]);
	des[15] |= (src[15]);
	des[16] |= (src[16]);
	des[17] |= (src[17]);
	des[18] |= (src[18]);
	des[19] |= (src[19]);
	des[20] |= (src[20]);
	des[21] |= (src[21]);
	des[22] |= (src[22]);
	des[23] |= (src[23]);
	des[24] |= (src[24]);
	des[25] |= (src[25]);
	des[26] |= (src[26]);
	des[27] |= (src[27]);
	des[28] |= (src[28]);
	des[29] |= (src[29]);
	des[30] |= (src[30]);
	des[31] |= (src[31]);
}

template<typename T>
void AFOR_pack_16_1(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1);
	des[0] |= (src[1] & 1) << 1;
	des[0] |= (src[2] & 1) << 2;
	des[0] |= (src[3] & 1) << 3;
	des[0] |= (src[4] & 1) << 4;
	des[0] |= (src[5] & 1) << 5;
	des[0] |= (src[6] & 1) << 6;
	des[0] |= (src[7] & 1) << 7;
	des[0] |= (src[8] & 1) << 8;
	des[0] |= (src[9] & 1) << 9;
	des[0] |= (src[10] & 1) << 10;
	des[0] |= (src[11] & 1) << 11;
	des[0] |= (src[12] & 1) << 12;
	des[0] |= (src[13] & 1) << 13;
	des[0] |= (src[14] & 1) << 14;
	des[0] |= (src[15] & 1) << 15;
}

template<typename T>
void AFOR_pack_16_2(uint32_t * des, const T *src) {
	des[0] = (src[0] & 3);
	des[0] |= (src[1] & 3) << 2;
	des[0] |= (src[2] & 3) << 4;
	des[0] |= (src[3] & 3) << 6;
	des[0] |= (src[4] & 3) << 8;
	des[0] |= (src[5] & 3) << 10;
	des[0] |= (src[6] & 3) << 12;
	des[0] |= (src[7] & 3) << 14;
	des[0] |= (src[8] & 3) << 16;
	des[0] |= (src[9] & 3) << 18;
	des[0] |= (src[10] & 3) << 20;
	des[0] |= (src[11] & 3) << 22;
	des[0] |= (src[12] & 3) << 24;
	des[0] |= (src[13] & 3) << 26;
	des[0] |= (src[14] & 3) << 28;
	des[0] |= (src[15] & 3) << 30;
}

template<typename T>
void AFOR_pack_16_3(uint32_t * des, const T *src) {
	des[0] = (src[0] & 7);
	des[0] |= (src[1] & 7) << 3;
	des[0] |= (src[2] & 7) << 6;
	des[0] |= (src[3] & 7) << 9;
	des[0] |= (src[4] & 7) << 12;
	des[0] |= (src[5] & 7) << 15;
	des[0] |= (src[6] & 7) << 18;
	des[0] |= (src[7] & 7) << 21;
	des[0] |= (src[8] & 7) << 24;
	des[0] |= (src[9] & 7) << 27;
	des[0] |= (src[10] & 7) << 30;
	des[1] = (src[10] & 7) >> 2;
	des[1] |= (src[11] & 7) << 1;
	des[1] |= (src[12] & 7) << 4;
	des[1] |= (src[13] & 7) << 7;
	des[1] |= (src[14] & 7) << 10;
	des[1] |= (src[15] & 7) << 13;
}

template<typename T>
void AFOR_pack_16_4(uint32_t * des, const T *src) {
	des[0] = (src[0] & 15);
	des[0] |= (src[1] & 15) << 4;
	des[0] |= (src[2] & 15) << 8;
	des[0] |= (src[3] & 15) << 12;
	des[0] |= (src[4] & 15) << 16;
	des[0] |= (src[5] & 15) << 20;
	des[0] |= (src[6] & 15) << 24;
	des[0] |= (src[7] & 15) << 28;
	des[1] = (src[8] & 15);
	des[1] |= (src[9] & 15) << 4;
	des[1] |= (src[10] & 15) << 8;
	des[1] |= (src[11] & 15) << 12;
	des[1] |= (src[12] & 15) << 16;
	des[1] |= (src[13] & 15) << 20;
	des[1] |= (src[14] & 15) << 24;
	des[1] |= (src[15] & 15) << 28;
}

template<typename T>
void AFOR_pack_16_5(uint32_t * des, const T *src) {
	des[0] = (src[0] & 31);
	des[0] |= (src[1] & 31) << 5;
	des[0] |= (src[2] & 31) << 10;
	des[0] |= (src[3] & 31) << 15;
	des[0] |= (src[4] & 31) << 20;
	des[0] |= (src[5] & 31) << 25;
	des[0] |= (src[6] & 31) << 30;
	des[1] = (src[6] & 31) >> 2;
	des[1] |= (src[7] & 31) << 3;
	des[1] |= (src[8] & 31) << 8;
	des[1] |= (src[9] & 31) << 13;
	des[1] |= (src[10] & 31) << 18;
	des[1] |= (src[11] & 31) << 23;
	des[1] |= (src[12] & 31) << 28;
	des[2] = (src[12] & 31) >> 4;
	des[2] |= (src[13] & 31) << 1;
	des[2] |= (src[14] & 31) << 6;
	des[2] |= (src[15] & 31) << 11;
}

template<typename T>
void AFOR_pack_16_6(uint32_t * des, const T *src) {
	des[0] = (src[0] & 63);
	des[0] |= (src[1] & 63) << 6;
	des[0] |= (src[2] & 63) << 12;
	des[0] |= (src[3] & 63) << 18;
	des[0] |= (src[4] & 63) << 24;
	des[0] |= (src[5] & 63) << 30;
	des[1] = (src[5] & 63) >> 2;
	des[1] |= (src[6] & 63) << 4;
	des[1] |= (src[7] & 63) << 10;
	des[1] |= (src[8] & 63) << 16;
	des[1] |= (src[9] & 63) << 22;
	des[1] |= (src[10] & 63) << 28;
	des[2] = (src[10] & 63) >> 4;
	des[2] |= (src[11] & 63) << 2;
	des[2] |= (src[12] & 63) << 8;
	des[2] |= (src[13] & 63) << 14;
	des[2] |= (src[14] & 63) << 20;
	des[2] |= (src[15] & 63) << 26;
}

template<typename T>
void AFOR_pack_16_7(uint32_t * des, const T *src) {
	des[0] = (src[0] & 127);
	des[0] |= (src[1] & 127) << 7;
	des[0] |= (src[2] & 127) << 14;
	des[0] |= (src[3] & 127) << 21;
	des[0] |= (src[4] & 127) << 28;
	des[1] = (src[4] & 127) >> 4;
	des[1] |= (src[5] & 127) << 3;
	des[1] |= (src[6] & 127) << 10;
	des[1] |= (src[7] & 127) << 17;
	des[1] |= (src[8] & 127) << 24;
	des[1] |= (src[9] & 127) << 31;
	des[2] = (src[9] & 127) >> 1;
	des[2] |= (src[10] & 127) << 6;
	des[2] |= (src[11] & 127) << 13;
	des[2] |= (src[12] & 127) << 20;
	des[2] |= (src[13] & 127) << 27;
	des[3] = (src[13] & 127) >> 5;
	des[3] |= (src[14] & 127) << 2;
	des[3] |= (src[15] & 127) << 9;
}

template<typename T>
void AFOR_pack_16_8(uint32_t * des, const T *src) {
	des[0] = (src[0] & 255);
	des[0] |= (src[1] & 255) << 8;
	des[0] |= (src[2] & 255) << 16;
	des[0] |= (src[3] & 255) << 24;
	des[1] = (src[4] & 255);
	des[1] |= (src[5] & 255) << 8;
	des[1] |= (src[6] & 255) << 16;
	des[1] |= (src[7] & 255) << 24;
	des[2] = (src[8] & 255);
	des[2] |= (src[9] & 255) << 8;
	des[2] |= (src[10] & 255) << 16;
	des[2] |= (src[11] & 255) << 24;
	des[3] = (src[12] & 255);
	des[3] |= (src[13] & 255) << 8;
	des[3] |= (src[14] & 255) << 16;
	des[3] |= (src[15] & 255) << 24;
}

template<typename T>
void AFOR_pack_16_9(uint32_t * des, const T *src) {
	des[0] = (src[0] & 511);
	des[0] |= (src[1] & 511) << 9;
	des[0] |= (src[2] & 511) << 18;
	des[0] |= (src[3] & 511) << 27;
	des[1] = (src[3] & 511) >> 5;
	des[1] |= (src[4] & 511) << 4;
	des[1] |= (src[5] & 511) << 13;
	des[1] |= (src[6] & 511) << 22;
	des[1] |= (src[7] & 511) << 31;
	des[2] = (src[7] & 511) >> 1;
	des[2] |= (src[8] & 511) << 8;
	des[2] |= (src[9] & 511) << 17;
	des[2] |= (src[10] & 511) << 26;
	des[3] = (src[10] & 511) >> 6;
	des[3] |= (src[11] & 511) << 3;
	des[3] |= (src[12] & 511) << 12;
	des[3] |= (src[13] & 511) << 21;
	des[3] |= (src[14] & 511) << 30;
	des[4] = (src[14] & 511) >> 2;
	des[4] |= (src[15] & 511) << 7;
}

template<typename T>
void AFOR_pack_16_10(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1023);
	des[0] |= (src[1] & 1023) << 10;
	des[0] |= (src[2] & 1023) << 20;
	des[0] |= (src[3] & 1023) << 30;
	des[1] = (src[3] & 1023) >> 2;
	des[1] |= (src[4] & 1023) << 8;
	des[1] |= (src[5] & 1023) << 18;
	des[1] |= (src[6] & 1023) << 28;
	des[2] = (src[6] & 1023) >> 4;
	des[2] |= (src[7] & 1023) << 6;
	des[2] |= (src[8] & 1023) << 16;
	des[2] |= (src[9] & 1023) << 26;
	des[3] = (src[9] & 1023) >> 6;
	des[3] |= (src[10] & 1023) << 4;
	des[3] |= (src[11] & 1023) << 14;
	des[3] |= (src[12] & 1023) << 24;
	des[4] = (src[12] & 1023) >> 8;
	des[4] |= (src[13] & 1023) << 2;
	des[4] |= (src[14] & 1023) << 12;
	des[4] |= (src[15] & 1023) << 22;
}

template<typename T>
void AFOR_pack_16_11(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2047);
	des[0] |= (src[1] & 2047) << 11;
	des[0] |= (src[2] & 2047) << 22;
	des[1] = (src[2] & 2047) >> 10;
	des[1] |= (src[3] & 2047) << 1;
	des[1] |= (src[4] & 2047) << 12;
	des[1] |= (src[5] & 2047) << 23;
	des[2] = (src[5] & 2047) >> 9;
	des[2] |= (src[6] & 2047) << 2;
	des[2] |= (src[7] & 2047) << 13;
	des[2] |= (src[8] & 2047) << 24;
	des[3] = (src[8] & 2047) >> 8;
	des[3] |= (src[9] & 2047) << 3;
	des[3] |= (src[10] & 2047) << 14;
	des[3] |= (src[11] & 2047) << 25;
	des[4] = (src[11] & 2047) >> 7;
	des[4] |= (src[12] & 2047) << 4;
	des[4] |= (src[13] & 2047) << 15;
	des[4] |= (src[14] & 2047) << 26;
	des[5] = (src[14] & 2047) >> 6;
	des[5] |= (src[15] & 2047) << 5;
}

template<typename T>
void AFOR_pack_16_12(uint32_t * des, const T *src) {
	des[0] = (src[0] & 4095);
	des[0] |= (src[1] & 4095) << 12;
	des[0] |= (src[2] & 4095) << 24;
	des[1] = (src[2] & 4095) >> 8;
	des[1] |= (src[3] & 4095) << 4;
	des[1] |= (src[4] & 4095) << 16;
	des[1] |= (src[5] & 4095) << 28;
	des[2] = (src[5] & 4095) >> 4;
	des[2] |= (src[6] & 4095) << 8;
	des[2] |= (src[7] & 4095) << 20;
	des[3] = (src[8] & 4095);
	des[3] |= (src[9] & 4095) << 12;
	des[3] |= (src[10] & 4095) << 24;
	des[4] = (src[10] & 4095) >> 8;
	des[4] |= (src[11] & 4095) << 4;
	des[4] |= (src[12] & 4095) << 16;
	des[4] |= (src[13] & 4095) << 28;
	des[5] = (src[13] & 4095) >> 4;
	des[5] |= (src[14] & 4095) << 8;
	des[5] |= (src[15] & 4095) << 20;
}

template<typename T>
void AFOR_pack_16_13(uint32_t * des, const T *src) {
	des[0] = (src[0] & 8191);
	des[0] |= (src[1] & 8191) << 13;
	des[0] |= (src[2] & 8191) << 26;
	des[1] = (src[2] & 8191) >> 6;
	des[1] |= (src[3] & 8191) << 7;
	des[1] |= (src[4] & 8191) << 20;
	des[2] = (src[4] & 8191) >> 12;
	des[2] |= (src[5] & 8191) << 1;
	des[2] |= (src[6] & 8191) << 14;
	des[2] |= (src[7] & 8191) << 27;
	des[3] = (src[7] & 8191) >> 5;
	des[3] |= (src[8] & 8191) << 8;
	des[3] |= (src[9] & 8191) << 21;
	des[4] = (src[9] & 8191) >> 11;
	des[4] |= (src[10] & 8191) << 2;
	des[4] |= (src[11] & 8191) << 15;
	des[4] |= (src[12] & 8191) << 28;
	des[5] = (src[12] & 8191) >> 4;
	des[5] |= (src[13] & 8191) << 9;
	des[5] |= (src[14] & 8191) << 22;
	des[6] = (src[14] & 8191) >> 10;
	des[6] |= (src[15] & 8191) << 3;
}

template<typename T>
void AFOR_pack_16_14(uint32_t * des, const T *src) {
	des[0] = (src[0] & 16383);
	des[0] |= (src[1] & 16383) << 14;
	des[0] |= (src[2] & 16383) << 28;
	des[1] = (src[2] & 16383) >> 4;
	des[1] |= (src[3] & 16383) << 10;
	des[1] |= (src[4] & 16383) << 24;
	des[2] = (src[4] & 16383) >> 8;
	des[2] |= (src[5] & 16383) << 6;
	des[2] |= (src[6] & 16383) << 20;
	des[3] = (src[6] & 16383) >> 12;
	des[3] |= (src[7] & 16383) << 2;
	des[3] |= (src[8] & 16383) << 16;
	des[3] |= (src[9] & 16383) << 30;
	des[4] = (src[9] & 16383) >> 2;
	des[4] |= (src[10] & 16383) << 12;
	des[4] |= (src[11] & 16383) << 26;
	des[5] = (src[11] & 16383) >> 6;
	des[5] |= (src[12] & 16383) << 8;
	des[5] |= (src[13] & 16383) << 22;
	des[6] = (src[13] & 16383) >> 10;
	des[6] |= (src[14] & 16383) << 4;
	des[6] |= (src[15] & 16383) << 18;
}

template<typename T>
void AFOR_pack_16_15(uint32_t * des, const T *src) {
	des[0] = (src[0] & 32767);
	des[0] |= (src[1] & 32767) << 15;
	des[0] |= (src[2] & 32767) << 30;
	des[1] = (src[2] & 32767) >> 2;
	des[1] |= (src[3] & 32767) << 13;
	des[1] |= (src[4] & 32767) << 28;
	des[2] = (src[4] & 32767) >> 4;
	des[2] |= (src[5] & 32767) << 11;
	des[2] |= (src[6] & 32767) << 26;
	des[3] = (src[6] & 32767) >> 6;
	des[3] |= (src[7] & 32767) << 9;
	des[3] |= (src[8] & 32767) << 24;
	des[4] = (src[8] & 32767) >> 8;
	des[4] |= (src[9] & 32767) << 7;
	des[4] |= (src[10] & 32767) << 22;
	des[5] = (src[10] & 32767) >> 10;
	des[5] |= (src[11] & 32767) << 5;
	des[5] |= (src[12] & 32767) << 20;
	des[6] = (src[12] & 32767) >> 12;
	des[6] |= (src[13] & 32767) << 3;
	des[6] |= (src[14] & 32767) << 18;
	des[7] = (src[14] & 32767) >> 14;
	des[7] |= (src[15] & 32767) << 1;
}

template<typename T>
void AFOR_pack_16_16(uint32_t * des, const T *src) {
	des[0] = (src[0] & 65535);
	des[0] |= (src[1] & 65535) << 16;
	des[1] = (src[2] & 65535);
	des[1] |= (src[3] & 65535) << 16;
	des[2] = (src[4] & 65535);
	des[2] |= (src[5] & 65535) << 16;
	des[3] = (src[6] & 65535);
	des[3] |= (src[7] & 65535) << 16;
	des[4] = (src[8] & 65535);
	des[4] |= (src[9] & 65535) << 16;
	des[5] = (src[10] & 65535);
	des[5] |= (src[11] & 65535) << 16;
	des[6] = (src[12] & 65535);
	des[6] |= (src[13] & 65535) << 16;
	des[7] = (src[14] & 65535);
	des[7] |= (src[15] & 65535) << 16;
}

template<typename T>
void AFOR_pack_16_17(uint32_t * des, const T *src) {
	des[0] = (src[0] & 131071);
	des[0] |= (src[1] & 131071) << 17;
	des[1] = (src[1] & 131071) >> 15;
	des[1] |= (src[2] & 131071) << 2;
	des[1] |= (src[3] & 131071) << 19;
	des[2] = (src[3] & 131071) >> 13;
	des[2] |= (src[4] & 131071) << 4;
	des[2] |= (src[5] & 131071) << 21;
	des[3] = (src[5] & 131071) >> 11;
	des[3] |= (src[6] & 131071) << 6;
	des[3] |= (src[7] & 131071) << 23;
	des[4] = (src[7] & 131071) >> 9;
	des[4] |= (src[8] & 131071) << 8;
	des[4] |= (src[9] & 131071) << 25;
	des[5] = (src[9] & 131071) >> 7;
	des[5] |= (src[10] & 131071) << 10;
	des[5] |= (src[11] & 131071) << 27;
	des[6] = (src[11] & 131071) >> 5;
	des[6] |= (src[12] & 131071) << 12;
	des[6] |= (src[13] & 131071) << 29;
	des[7] = (src[13] & 131071) >> 3;
	des[7] |= (src[14] & 131071) << 14;
	des[7] |= (src[15] & 131071) << 31;
	des[8] = (src[15] & 131071) >> 1;
}

template<typename T>
void AFOR_pack_16_18(uint32_t * des, const T *src) {
	des[0] = (src[0] & 262143);
	des[0] |= (src[1] & 262143) << 18;
	des[1] = (src[1] & 262143) >> 14;
	des[1] |= (src[2] & 262143) << 4;
	des[1] |= (src[3] & 262143) << 22;
	des[2] = (src[3] & 262143) >> 10;
	des[2] |= (src[4] & 262143) << 8;
	des[2] |= (src[5] & 262143) << 26;
	des[3] = (src[5] & 262143) >> 6;
	des[3] |= (src[6] & 262143) << 12;
	des[3] |= (src[7] & 262143) << 30;
	des[4] = (src[7] & 262143) >> 2;
	des[4] |= (src[8] & 262143) << 16;
	des[5] = (src[8] & 262143) >> 16;
	des[5] |= (src[9] & 262143) << 2;
	des[5] |= (src[10] & 262143) << 20;
	des[6] = (src[10] & 262143) >> 12;
	des[6] |= (src[11] & 262143) << 6;
	des[6] |= (src[12] & 262143) << 24;
	des[7] = (src[12] & 262143) >> 8;
	des[7] |= (src[13] & 262143) << 10;
	des[7] |= (src[14] & 262143) << 28;
	des[8] = (src[14] & 262143) >> 4;
	des[8] |= (src[15] & 262143) << 14;
}

template<typename T>
void AFOR_pack_16_19(uint32_t * des, const T *src) {
	des[0] = (src[0] & 524287);
	des[0] |= (src[1] & 524287) << 19;
	des[1] = (src[1] & 524287) >> 13;
	des[1] |= (src[2] & 524287) << 6;
	des[1] |= (src[3] & 524287) << 25;
	des[2] = (src[3] & 524287) >> 7;
	des[2] |= (src[4] & 524287) << 12;
	des[2] |= (src[5] & 524287) << 31;
	des[3] = (src[5] & 524287) >> 1;
	des[3] |= (src[6] & 524287) << 18;
	des[4] = (src[6] & 524287) >> 14;
	des[4] |= (src[7] & 524287) << 5;
	des[4] |= (src[8] & 524287) << 24;
	des[5] = (src[8] & 524287) >> 8;
	des[5] |= (src[9] & 524287) << 11;
	des[5] |= (src[10] & 524287) << 30;
	des[6] = (src[10] & 524287) >> 2;
	des[6] |= (src[11] & 524287) << 17;
	des[7] = (src[11] & 524287) >> 15;
	des[7] |= (src[12] & 524287) << 4;
	des[7] |= (src[13] & 524287) << 23;
	des[8] = (src[13] & 524287) >> 9;
	des[8] |= (src[14] & 524287) << 10;
	des[8] |= (src[15] & 524287) << 29;
	des[9] = (src[15] & 524287) >> 3;
}

template<typename T>
void AFOR_pack_16_20(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1048575);
	des[0] |= (src[1] & 1048575) << 20;
	des[1] = (src[1] & 1048575) >> 12;
	des[1] |= (src[2] & 1048575) << 8;
	des[1] |= (src[3] & 1048575) << 28;
	des[2] = (src[3] & 1048575) >> 4;
	des[2] |= (src[4] & 1048575) << 16;
	des[3] = (src[4] & 1048575) >> 16;
	des[3] |= (src[5] & 1048575) << 4;
	des[3] |= (src[6] & 1048575) << 24;
	des[4] = (src[6] & 1048575) >> 8;
	des[4] |= (src[7] & 1048575) << 12;
	des[5] = (src[8] & 1048575);
	des[5] |= (src[9] & 1048575) << 20;
	des[6] = (src[9] & 1048575) >> 12;
	des[6] |= (src[10] & 1048575) << 8;
	des[6] |= (src[11] & 1048575) << 28;
	des[7] = (src[11] & 1048575) >> 4;
	des[7] |= (src[12] & 1048575) << 16;
	des[8] = (src[12] & 1048575) >> 16;
	des[8] |= (src[13] & 1048575) << 4;
	des[8] |= (src[14] & 1048575) << 24;
	des[9] = (src[14] & 1048575) >> 8;
	des[9] |= (src[15] & 1048575) << 12;
}

template<typename T>
void AFOR_pack_16_21(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2097151);
	des[0] |= (src[1] & 2097151) << 21;
	des[1] = (src[1] & 2097151) >> 11;
	des[1] |= (src[2] & 2097151) << 10;
	des[1] |= (src[3] & 2097151) << 31;
	des[2] = (src[3] & 2097151) >> 1;
	des[2] |= (src[4] & 2097151) << 20;
	des[3] = (src[4] & 2097151) >> 12;
	des[3] |= (src[5] & 2097151) << 9;
	des[3] |= (src[6] & 2097151) << 30;
	des[4] = (src[6] & 2097151) >> 2;
	des[4] |= (src[7] & 2097151) << 19;
	des[5] = (src[7] & 2097151) >> 13;
	des[5] |= (src[8] & 2097151) << 8;
	des[5] |= (src[9] & 2097151) << 29;
	des[6] = (src[9] & 2097151) >> 3;
	des[6] |= (src[10] & 2097151) << 18;
	des[7] = (src[10] & 2097151) >> 14;
	des[7] |= (src[11] & 2097151) << 7;
	des[7] |= (src[12] & 2097151) << 28;
	des[8] = (src[12] & 2097151) >> 4;
	des[8] |= (src[13] & 2097151) << 17;
	des[9] = (src[13] & 2097151) >> 15;
	des[9] |= (src[14] & 2097151) << 6;
	des[9] |= (src[15] & 2097151) << 27;
	des[10] = (src[15] & 2097151) >> 5;
}

template<typename T>
void AFOR_pack_16_22(uint32_t * des, const T *src) {
	des[0] = (src[0] & 4194303);
	des[0] |= (src[1] & 4194303) << 22;
	des[1] = (src[1] & 4194303) >> 10;
	des[1] |= (src[2] & 4194303) << 12;
	des[2] = (src[2] & 4194303) >> 20;
	des[2] |= (src[3] & 4194303) << 2;
	des[2] |= (src[4] & 4194303) << 24;
	des[3] = (src[4] & 4194303) >> 8;
	des[3] |= (src[5] & 4194303) << 14;
	des[4] = (src[5] & 4194303) >> 18;
	des[4] |= (src[6] & 4194303) << 4;
	des[4] |= (src[7] & 4194303) << 26;
	des[5] = (src[7] & 4194303) >> 6;
	des[5] |= (src[8] & 4194303) << 16;
	des[6] = (src[8] & 4194303) >> 16;
	des[6] |= (src[9] & 4194303) << 6;
	des[6] |= (src[10] & 4194303) << 28;
	des[7] = (src[10] & 4194303) >> 4;
	des[7] |= (src[11] & 4194303) << 18;
	des[8] = (src[11] & 4194303) >> 14;
	des[8] |= (src[12] & 4194303) << 8;
	des[8] |= (src[13] & 4194303) << 30;
	des[9] = (src[13] & 4194303) >> 2;
	des[9] |= (src[14] & 4194303) << 20;
	des[10] = (src[14] & 4194303) >> 12;
	des[10] |= (src[15] & 4194303) << 10;
}

template<typename T>
void AFOR_pack_16_23(uint32_t * des, const T *src) {
	des[0] = (src[0] & 8388607);
	des[0] |= (src[1] & 8388607) << 23;
	des[1] = (src[1] & 8388607) >> 9;
	des[1] |= (src[2] & 8388607) << 14;
	des[2] = (src[2] & 8388607) >> 18;
	des[2] |= (src[3] & 8388607) << 5;
	des[2] |= (src[4] & 8388607) << 28;
	des[3] = (src[4] & 8388607) >> 4;
	des[3] |= (src[5] & 8388607) << 19;
	des[4] = (src[5] & 8388607) >> 13;
	des[4] |= (src[6] & 8388607) << 10;
	des[5] = (src[6] & 8388607) >> 22;
	des[5] |= (src[7] & 8388607) << 1;
	des[5] |= (src[8] & 8388607) << 24;
	des[6] = (src[8] & 8388607) >> 8;
	des[6] |= (src[9] & 8388607) << 15;
	des[7] = (src[9] & 8388607) >> 17;
	des[7] |= (src[10] & 8388607) << 6;
	des[7] |= (src[11] & 8388607) << 29;
	des[8] = (src[11] & 8388607) >> 3;
	des[8] |= (src[12] & 8388607) << 20;
	des[9] = (src[12] & 8388607) >> 12;
	des[9] |= (src[13] & 8388607) << 11;
	des[10] = (src[13] & 8388607) >> 21;
	des[10] |= (src[14] & 8388607) << 2;
	des[10] |= (src[15] & 8388607) << 25;
	des[11] = (src[15] & 8388607) >> 7;
}

template<typename T>
void AFOR_pack_16_24(uint32_t * des, const T *src) {
	des[0] = (src[0] & 16777215);
	des[0] |= (src[1] & 16777215) << 24;
	des[1] = (src[1] & 16777215) >> 8;
	des[1] |= (src[2] & 16777215) << 16;
	des[2] = (src[2] & 16777215) >> 16;
	des[2] |= (src[3] & 16777215) << 8;
	des[3] = (src[4] & 16777215);
	des[3] |= (src[5] & 16777215) << 24;
	des[4] = (src[5] & 16777215) >> 8;
	des[4] |= (src[6] & 16777215) << 16;
	des[5] = (src[6] & 16777215) >> 16;
	des[5] |= (src[7] & 16777215) << 8;
	des[6] = (src[8] & 16777215);
	des[6] |= (src[9] & 16777215) << 24;
	des[7] = (src[9] & 16777215) >> 8;
	des[7] |= (src[10] & 16777215) << 16;
	des[8] = (src[10] & 16777215) >> 16;
	des[8] |= (src[11] & 16777215) << 8;
	des[9] = (src[12] & 16777215);
	des[9] |= (src[13] & 16777215) << 24;
	des[10] = (src[13] & 16777215) >> 8;
	des[10] |= (src[14] & 16777215) << 16;
	des[11] = (src[14] & 16777215) >> 16;
	des[11] |= (src[15] & 16777215) << 8;
}

template<typename T>
void AFOR_pack_16_25(uint32_t * des, const T *src) {
	des[0] = (src[0] & 33554431);
	des[0] |= (src[1] & 33554431) << 25;
	des[1] = (src[1] & 33554431) >> 7;
	des[1] |= (src[2] & 33554431) << 18;
	des[2] = (src[2] & 33554431) >> 14;
	des[2] |= (src[3] & 33554431) << 11;
	des[3] = (src[3] & 33554431) >> 21;
	des[3] |= (src[4] & 33554431) << 4;
	des[3] |= (src[5] & 33554431) << 29;
	des[4] = (src[5] & 33554431) >> 3;
	des[4] |= (src[6] & 33554431) << 22;
	des[5] = (src[6] & 33554431) >> 10;
	des[5] |= (src[7] & 33554431) << 15;
	des[6] = (src[7] & 33554431) >> 17;
	des[6] |= (src[8] & 33554431) << 8;
	des[7] = (src[8] & 33554431) >> 24;
	des[7] |= (src[9] & 33554431) << 1;
	des[7] |= (src[10] & 33554431) << 26;
	des[8] = (src[10] & 33554431) >> 6;
	des[8] |= (src[11] & 33554431) << 19;
	des[9] = (src[11] & 33554431) >> 13;
	des[9] |= (src[12] & 33554431) << 12;
	des[10] = (src[12] & 33554431) >> 20;
	des[10] |= (src[13] & 33554431) << 5;
	des[10] |= (src[14] & 33554431) << 30;
	des[11] = (src[14] & 33554431) >> 2;
	des[11] |= (src[15] & 33554431) << 23;
	des[12] = (src[15] & 33554431) >> 9;
}

template<typename T>
void AFOR_pack_16_26(uint32_t * des, const T *src) {
	des[0] = (src[0] & 67108863);
	des[0] |= (src[1] & 67108863) << 26;
	des[1] = (src[1] & 67108863) >> 6;
	des[1] |= (src[2] & 67108863) << 20;
	des[2] = (src[2] & 67108863) >> 12;
	des[2] |= (src[3] & 67108863) << 14;
	des[3] = (src[3] & 67108863) >> 18;
	des[3] |= (src[4] & 67108863) << 8;
	des[4] = (src[4] & 67108863) >> 24;
	des[4] |= (src[5] & 67108863) << 2;
	des[4] |= (src[6] & 67108863) << 28;
	des[5] = (src[6] & 67108863) >> 4;
	des[5] |= (src[7] & 67108863) << 22;
	des[6] = (src[7] & 67108863) >> 10;
	des[6] |= (src[8] & 67108863) << 16;
	des[7] = (src[8] & 67108863) >> 16;
	des[7] |= (src[9] & 67108863) << 10;
	des[8] = (src[9] & 67108863) >> 22;
	des[8] |= (src[10] & 67108863) << 4;
	des[8] |= (src[11] & 67108863) << 30;
	des[9] = (src[11] & 67108863) >> 2;
	des[9] |= (src[12] & 67108863) << 24;
	des[10] = (src[12] & 67108863) >> 8;
	des[10] |= (src[13] & 67108863) << 18;
	des[11] = (src[13] & 67108863) >> 14;
	des[11] |= (src[14] & 67108863) << 12;
	des[12] = (src[14] & 67108863) >> 20;
	des[12] |= (src[15] & 67108863) << 6;
}

template<typename T>
void AFOR_pack_16_27(uint32_t * des, const T *src) {
	des[0] = (src[0] & 134217727);
	des[0] |= (src[1] & 134217727) << 27;
	des[1] = (src[1] & 134217727) >> 5;
	des[1] |= (src[2] & 134217727) << 22;
	des[2] = (src[2] & 134217727) >> 10;
	des[2] |= (src[3] & 134217727) << 17;
	des[3] = (src[3] & 134217727) >> 15;
	des[3] |= (src[4] & 134217727) << 12;
	des[4] = (src[4] & 134217727) >> 20;
	des[4] |= (src[5] & 134217727) << 7;
	des[5] = (src[5] & 134217727) >> 25;
	des[5] |= (src[6] & 134217727) << 2;
	des[5] |= (src[7] & 134217727) << 29;
	des[6] = (src[7] & 134217727) >> 3;
	des[6] |= (src[8] & 134217727) << 24;
	des[7] = (src[8] & 134217727) >> 8;
	des[7] |= (src[9] & 134217727) << 19;
	des[8] = (src[9] & 134217727) >> 13;
	des[8] |= (src[10] & 134217727) << 14;
	des[9] = (src[10] & 134217727) >> 18;
	des[9] |= (src[11] & 134217727) << 9;
	des[10] = (src[11] & 134217727) >> 23;
	des[10] |= (src[12] & 134217727) << 4;
	des[10] |= (src[13] & 134217727) << 31;
	des[11] = (src[13] & 134217727) >> 1;
	des[11] |= (src[14] & 134217727) << 26;
	des[12] = (src[14] & 134217727) >> 6;
	des[12] |= (src[15] & 134217727) << 21;
	des[13] = (src[15] & 134217727) >> 11;
}

template<typename T>
void AFOR_pack_16_28(uint32_t * des, const T *src) {
	des[0] = (src[0] & 268435455);
	des[0] |= (src[1] & 268435455) << 28;
	des[1] = (src[1] & 268435455) >> 4;
	des[1] |= (src[2] & 268435455) << 24;
	des[2] = (src[2] & 268435455) >> 8;
	des[2] |= (src[3] & 268435455) << 20;
	des[3] = (src[3] & 268435455) >> 12;
	des[3] |= (src[4] & 268435455) << 16;
	des[4] = (src[4] & 268435455) >> 16;
	des[4] |= (src[5] & 268435455) << 12;
	des[5] = (src[5] & 268435455) >> 20;
	des[5] |= (src[6] & 268435455) << 8;
	des[6] = (src[6] & 268435455) >> 24;
	des[6] |= (src[7] & 268435455) << 4;
	des[7] = (src[8] & 268435455);
	des[7] |= (src[9] & 268435455) << 28;
	des[8] = (src[9] & 268435455) >> 4;
	des[8] |= (src[10] & 268435455) << 24;
	des[9] = (src[10] & 268435455) >> 8;
	des[9] |= (src[11] & 268435455) << 20;
	des[10] = (src[11] & 268435455) >> 12;
	des[10] |= (src[12] & 268435455) << 16;
	des[11] = (src[12] & 268435455) >> 16;
	des[11] |= (src[13] & 268435455) << 12;
	des[12] = (src[13] & 268435455) >> 20;
	des[12] |= (src[14] & 268435455) << 8;
	des[13] = (src[14] & 268435455) >> 24;
	des[13] |= (src[15] & 268435455) << 4;
}

template<typename T>
void AFOR_pack_16_29(uint32_t * des, const T *src) {
	des[0] = (src[0] & 536870911);
	des[0] |= (src[1] & 536870911) << 29;
	des[1] = (src[1] & 536870911) >> 3;
	des[1] |= (src[2] & 536870911) << 26;
	des[2] = (src[2] & 536870911) >> 6;
	des[2] |= (src[3] & 536870911) << 23;
	des[3] = (src[3] & 536870911) >> 9;
	des[3] |= (src[4] & 536870911) << 20;
	des[4] = (src[4] & 536870911) >> 12;
	des[4] |= (src[5] & 536870911) << 17;
	des[5] = (src[5] & 536870911) >> 15;
	des[5] |= (src[6] & 536870911) << 14;
	des[6] = (src[6] & 536870911) >> 18;
	des[6] |= (src[7] & 536870911) << 11;
	des[7] = (src[7] & 536870911) >> 21;
	des[7] |= (src[8] & 536870911) << 8;
	des[8] = (src[8] & 536870911) >> 24;
	des[8] |= (src[9] & 536870911) << 5;
	des[9] = (src[9] & 536870911) >> 27;
	des[9] |= (src[10] & 536870911) << 2;
	des[9] |= (src[11] & 536870911) << 31;
	des[10] = (src[11] & 536870911) >> 1;
	des[10] |= (src[12] & 536870911) << 28;
	des[11] = (src[12] & 536870911) >> 4;
	des[11] |= (src[13] & 536870911) << 25;
	des[12] = (src[13] & 536870911) >> 7;
	des[12] |= (src[14] & 536870911) << 22;
	des[13] = (src[14] & 536870911) >> 10;
	des[13] |= (src[15] & 536870911) << 19;
	des[14] = (src[15] & 536870911) >> 13;
}

template<typename T>
void AFOR_pack_16_30(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1073741823);
	des[0] |= (src[1] & 1073741823) << 30;
	des[1] = (src[1] & 1073741823) >> 2;
	des[1] |= (src[2] & 1073741823) << 28;
	des[2] = (src[2] & 1073741823) >> 4;
	des[2] |= (src[3] & 1073741823) << 26;
	des[3] = (src[3] & 1073741823) >> 6;
	des[3] |= (src[4] & 1073741823) << 24;
	des[4] = (src[4] & 1073741823) >> 8;
	des[4] |= (src[5] & 1073741823) << 22;
	des[5] = (src[5] & 1073741823) >> 10;
	des[5] |= (src[6] & 1073741823) << 20;
	des[6] = (src[6] & 1073741823) >> 12;
	des[6] |= (src[7] & 1073741823) << 18;
	des[7] = (src[7] & 1073741823) >> 14;
	des[7] |= (src[8] & 1073741823) << 16;
	des[8] = (src[8] & 1073741823) >> 16;
	des[8] |= (src[9] & 1073741823) << 14;
	des[9] = (src[9] & 1073741823) >> 18;
	des[9] |= (src[10] & 1073741823) << 12;
	des[10] = (src[10] & 1073741823) >> 20;
	des[10] |= (src[11] & 1073741823) << 10;
	des[11] = (src[11] & 1073741823) >> 22;
	des[11] |= (src[12] & 1073741823) << 8;
	des[12] = (src[12] & 1073741823) >> 24;
	des[12] |= (src[13] & 1073741823) << 6;
	des[13] = (src[13] & 1073741823) >> 26;
	des[13] |= (src[14] & 1073741823) << 4;
	des[14] = (src[14] & 1073741823) >> 28;
	des[14] |= (src[15] & 1073741823) << 2;
}

template<typename T>
void AFOR_pack_16_31(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2147483647);
	des[0] |= (src[1] & 2147483647) << 31;
	des[1] = (src[1] & 2147483647) >> 1;
	des[1] |= (src[2] & 2147483647) << 30;
	des[2] = (src[2] & 2147483647) >> 2;
	des[2] |= (src[3] & 2147483647) << 29;
	des[3] = (src[3] & 2147483647) >> 3;
	des[3] |= (src[4] & 2147483647) << 28;
	des[4] = (src[4] & 2147483647) >> 4;
	des[4] |= (src[5] & 2147483647) << 27;
	des[5] = (src[5] & 2147483647) >> 5;
	des[5] |= (src[6] & 2147483647) << 26;
	des[6] = (src[6] & 2147483647) >> 6;
	des[6] |= (src[7] & 2147483647) << 25;
	des[7] = (src[7] & 2147483647) >> 7;
	des[7] |= (src[8] & 2147483647) << 24;
	des[8] = (src[8] & 2147483647) >> 8;
	des[8] |= (src[9] & 2147483647) << 23;
	des[9] = (src[9] & 2147483647) >> 9;
	des[9] |= (src[10] & 2147483647) << 22;
	des[10] = (src[10] & 2147483647) >> 10;
	des[10] |= (src[11] & 2147483647) << 21;
	des[11] = (src[11] & 2147483647) >> 11;
	des[11] |= (src[12] & 2147483647) << 20;
	des[12] = (src[12] & 2147483647) >> 12;
	des[12] |= (src[13] & 2147483647) << 19;
	des[13] = (src[13] & 2147483647) >> 13;
	des[13] |= (src[14] & 2147483647) << 18;
	des[14] = (src[14] & 2147483647) >> 14;
	des[14] |= (src[15] & 2147483647) << 17;
	des[15] = (src[15] & 2147483647) >> 15;
}

template<typename T>
void AFOR_pack_16_32(uint32_t * des, const T *src) {
	des[0] |= (src[0]);
	des[1] |= (src[1]);
	des[2] |= (src[2]);
	des[3] |= (src[3]);
	des[4] |= (src[4]);
	des[5] |= (src[5]);
	des[6] |= (src[6]);
	des[7] |= (src[7]);
	des[8] |= (src[8]);
	des[9] |= (src[9]);
	des[10] |= (src[10]);
	des[11] |= (src[11]);
	des[12] |= (src[12]);
	des[13] |= (src[13]);
	des[14] |= (src[14]);
	des[15] |= (src[15]);
}

template<typename T>
void AFOR_pack_8_1(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1);
	des[0] |= (src[1] & 1) << 1;
	des[0] |= (src[2] & 1) << 2;
	des[0] |= (src[3] & 1) << 3;
	des[0] |= (src[4] & 1) << 4;
	des[0] |= (src[5] & 1) << 5;
	des[0] |= (src[6] & 1) << 6;
	des[0] |= (src[7] & 1) << 7;
}

template<typename T>
void AFOR_pack_8_2(uint32_t * des, const T *src) {
	des[0] = (src[0] & 3);
	des[0] |= (src[1] & 3) << 2;
	des[0] |= (src[2] & 3) << 4;
	des[0] |= (src[3] & 3) << 6;
	des[0] |= (src[4] & 3) << 8;
	des[0] |= (src[5] & 3) << 10;
	des[0] |= (src[6] & 3) << 12;
	des[0] |= (src[7] & 3) << 14;
}

template<typename T>
void AFOR_pack_8_3(uint32_t * des, const T *src) {
	des[0] = (src[0] & 7);
	des[0] |= (src[1] & 7) << 3;
	des[0] |= (src[2] & 7) << 6;
	des[0] |= (src[3] & 7) << 9;
	des[0] |= (src[4] & 7) << 12;
	des[0] |= (src[5] & 7) << 15;
	des[0] |= (src[6] & 7) << 18;
	des[0] |= (src[7] & 7) << 21;
}

template<typename T>
void AFOR_pack_8_4(uint32_t * des, const T *src) {
	des[0] = (src[0] & 15);
	des[0] |= (src[1] & 15) << 4;
	des[0] |= (src[2] & 15) << 8;
	des[0] |= (src[3] & 15) << 12;
	des[0] |= (src[4] & 15) << 16;
	des[0] |= (src[5] & 15) << 20;
	des[0] |= (src[6] & 15) << 24;
	des[0] |= (src[7] & 15) << 28;
}

template<typename T>
void AFOR_pack_8_5(uint32_t * des, const T *src) {
	des[0] = (src[0] & 31);
	des[0] |= (src[1] & 31) << 5;
	des[0] |= (src[2] & 31) << 10;
	des[0] |= (src[3] & 31) << 15;
	des[0] |= (src[4] & 31) << 20;
	des[0] |= (src[5] & 31) << 25;
	des[0] |= (src[6] & 31) << 30;
	des[1] = (src[6] & 31) >> 2;
	des[1] |= (src[7] & 31) << 3;
}

template<typename T>
void AFOR_pack_8_6(uint32_t * des, const T *src) {
	des[0] = (src[0] & 63);
	des[0] |= (src[1] & 63) << 6;
	des[0] |= (src[2] & 63) << 12;
	des[0] |= (src[3] & 63) << 18;
	des[0] |= (src[4] & 63) << 24;
	des[0] |= (src[5] & 63) << 30;
	des[1] = (src[5] & 63) >> 2;
	des[1] |= (src[6] & 63) << 4;
	des[1] |= (src[7] & 63) << 10;
}

template<typename T>
void AFOR_pack_8_7(uint32_t * des, const T *src) {
	des[0] = (src[0] & 127);
	des[0] |= (src[1] & 127) << 7;
	des[0] |= (src[2] & 127) << 14;
	des[0] |= (src[3] & 127) << 21;
	des[0] |= (src[4] & 127) << 28;
	des[1] = (src[4] & 127) >> 4;
	des[1] |= (src[5] & 127) << 3;
	des[1] |= (src[6] & 127) << 10;
	des[1] |= (src[7] & 127) << 17;
}

template<typename T>
void AFOR_pack_8_8(uint32_t * des, const T *src) {
	des[0] = (src[0] & 255);
	des[0] |= (src[1] & 255) << 8;
	des[0] |= (src[2] & 255) << 16;
	des[0] |= (src[3] & 255) << 24;
	des[1] = (src[4] & 255);
	des[1] |= (src[5] & 255) << 8;
	des[1] |= (src[6] & 255) << 16;
	des[1] |= (src[7] & 255) << 24;
}

template<typename T>
void AFOR_pack_8_9(uint32_t * des, const T *src) {
	des[0] = (src[0] & 511);
	des[0] |= (src[1] & 511) << 9;
	des[0] |= (src[2] & 511) << 18;
	des[0] |= (src[3] & 511) << 27;
	des[1] = (src[3] & 511) >> 5;
	des[1] |= (src[4] & 511) << 4;
	des[1] |= (src[5] & 511) << 13;
	des[1] |= (src[6] & 511) << 22;
	des[1] |= (src[7] & 511) << 31;
	des[2] = (src[7] & 511) >> 1;
}

template<typename T>
void AFOR_pack_8_10(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1023);
	des[0] |= (src[1] & 1023) << 10;
	des[0] |= (src[2] & 1023) << 20;
	des[0] |= (src[3] & 1023) << 30;
	des[1] = (src[3] & 1023) >> 2;
	des[1] |= (src[4] & 1023) << 8;
	des[1] |= (src[5] & 1023) << 18;
	des[1] |= (src[6] & 1023) << 28;
	des[2] = (src[6] & 1023) >> 4;
	des[2] |= (src[7] & 1023) << 6;
}

template<typename T>
void AFOR_pack_8_11(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2047);
	des[0] |= (src[1] & 2047) << 11;
	des[0] |= (src[2] & 2047) << 22;
	des[1] = (src[2] & 2047) >> 10;
	des[1] |= (src[3] & 2047) << 1;
	des[1] |= (src[4] & 2047) << 12;
	des[1] |= (src[5] & 2047) << 23;
	des[2] = (src[5] & 2047) >> 9;
	des[2] |= (src[6] & 2047) << 2;
	des[2] |= (src[7] & 2047) << 13;
}

template<typename T>
void AFOR_pack_8_12(uint32_t * des, const T *src) {
	des[0] = (src[0] & 4095);
	des[0] |= (src[1] & 4095) << 12;
	des[0] |= (src[2] & 4095) << 24;
	des[1] = (src[2] & 4095) >> 8;
	des[1] |= (src[3] & 4095) << 4;
	des[1] |= (src[4] & 4095) << 16;
	des[1] |= (src[5] & 4095) << 28;
	des[2] = (src[5] & 4095) >> 4;
	des[2] |= (src[6] & 4095) << 8;
	des[2] |= (src[7] & 4095) << 20;
}

template<typename T>
void AFOR_pack_8_13(uint32_t * des, const T *src) {
	des[0] = (src[0] & 8191);
	des[0] |= (src[1] & 8191) << 13;
	des[0] |= (src[2] & 8191) << 26;
	des[1] = (src[2] & 8191) >> 6;
	des[1] |= (src[3] & 8191) << 7;
	des[1] |= (src[4] & 8191) << 20;
	des[2] = (src[4] & 8191) >> 12;
	des[2] |= (src[5] & 8191) << 1;
	des[2] |= (src[6] & 8191) << 14;
	des[2] |= (src[7] & 8191) << 27;
	des[3] = (src[7] & 8191) >> 5;
}

template<typename T>
void AFOR_pack_8_14(uint32_t * des, const T *src) {
	des[0] = (src[0] & 16383);
	des[0] |= (src[1] & 16383) << 14;
	des[0] |= (src[2] & 16383) << 28;
	des[1] = (src[2] & 16383) >> 4;
	des[1] |= (src[3] & 16383) << 10;
	des[1] |= (src[4] & 16383) << 24;
	des[2] = (src[4] & 16383) >> 8;
	des[2] |= (src[5] & 16383) << 6;
	des[2] |= (src[6] & 16383) << 20;
	des[3] = (src[6] & 16383) >> 12;
	des[3] |= (src[7] & 16383) << 2;
}

template<typename T>
void AFOR_pack_8_15(uint32_t * des, const T *src) {
	des[0] = (src[0] & 32767);
	des[0] |= (src[1] & 32767) << 15;
	des[0] |= (src[2] & 32767) << 30;
	des[1] = (src[2] & 32767) >> 2;
	des[1] |= (src[3] & 32767) << 13;
	des[1] |= (src[4] & 32767) << 28;
	des[2] = (src[4] & 32767) >> 4;
	des[2] |= (src[5] & 32767) << 11;
	des[2] |= (src[6] & 32767) << 26;
	des[3] = (src[6] & 32767) >> 6;
	des[3] |= (src[7] & 32767) << 9;
}

template<typename T>
void AFOR_pack_8_16(uint32_t * des, const T *src) {
	des[0] = (src[0] & 65535);
	des[0] |= (src[1] & 65535) << 16;
	des[1] = (src[2] & 65535);
	des[1] |= (src[3] & 65535) << 16;
	des[2] = (src[4] & 65535);
	des[2] |= (src[5] & 65535) << 16;
	des[3] = (src[6] & 65535);
	des[3] |= (src[7] & 65535) << 16;
}

template<typename T>
void AFOR_pack_8_17(uint32_t * des, const T *src) {
	des[0] = (src[0] & 131071);
	des[0] |= (src[1] & 131071) << 17;
	des[1] = (src[1] & 131071) >> 15;
	des[1] |= (src[2] & 131071) << 2;
	des[1] |= (src[3] & 131071) << 19;
	des[2] = (src[3] & 131071) >> 13;
	des[2] |= (src[4] & 131071) << 4;
	des[2] |= (src[5] & 131071) << 21;
	des[3] = (src[5] & 131071) >> 11;
	des[3] |= (src[6] & 131071) << 6;
	des[3] |= (src[7] & 131071) << 23;
	des[4] = (src[7] & 131071) >> 9;
}

template<typename T>
void AFOR_pack_8_18(uint32_t * des, const T *src) {
	des[0] = (src[0] & 262143);
	des[0] |= (src[1] & 262143) << 18;
	des[1] = (src[1] & 262143) >> 14;
	des[1] |= (src[2] & 262143) << 4;
	des[1] |= (src[3] & 262143) << 22;
	des[2] = (src[3] & 262143) >> 10;
	des[2] |= (src[4] & 262143) << 8;
	des[2] |= (src[5] & 262143) << 26;
	des[3] = (src[5] & 262143) >> 6;
	des[3] |= (src[6] & 262143) << 12;
	des[3] |= (src[7] & 262143) << 30;
	des[4] = (src[7] & 262143) >> 2;
}

template<typename T>
void AFOR_pack_8_19(uint32_t * des, const T *src) {
	des[0] = (src[0] & 524287);
	des[0] |= (src[1] & 524287) << 19;
	des[1] = (src[1] & 524287) >> 13;
	des[1] |= (src[2] & 524287) << 6;
	des[1] |= (src[3] & 524287) << 25;
	des[2] = (src[3] & 524287) >> 7;
	des[2] |= (src[4] & 524287) << 12;
	des[2] |= (src[5] & 524287) << 31;
	des[3] = (src[5] & 524287) >> 1;
	des[3] |= (src[6] & 524287) << 18;
	des[4] = (src[6] & 524287) >> 14;
	des[4] |= (src[7] & 524287) << 5;
}

template<typename T>
void AFOR_pack_8_20(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1048575);
	des[0] |= (src[1] & 1048575) << 20;
	des[1] = (src[1] & 1048575) >> 12;
	des[1] |= (src[2] & 1048575) << 8;
	des[1] |= (src[3] & 1048575) << 28;
	des[2] = (src[3] & 1048575) >> 4;
	des[2] |= (src[4] & 1048575) << 16;
	des[3] = (src[4] & 1048575) >> 16;
	des[3] |= (src[5] & 1048575) << 4;
	des[3] |= (src[6] & 1048575) << 24;
	des[4] = (src[6] & 1048575) >> 8;
	des[4] |= (src[7] & 1048575) << 12;
}

template<typename T>
void AFOR_pack_8_21(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2097151);
	des[0] |= (src[1] & 2097151) << 21;
	des[1] = (src[1] & 2097151) >> 11;
	des[1] |= (src[2] & 2097151) << 10;
	des[1] |= (src[3] & 2097151) << 31;
	des[2] = (src[3] & 2097151) >> 1;
	des[2] |= (src[4] & 2097151) << 20;
	des[3] = (src[4] & 2097151) >> 12;
	des[3] |= (src[5] & 2097151) << 9;
	des[3] |= (src[6] & 2097151) << 30;
	des[4] = (src[6] & 2097151) >> 2;
	des[4] |= (src[7] & 2097151) << 19;
	des[5] = (src[7] & 2097151) >> 13;
}

template<typename T>
void AFOR_pack_8_22(uint32_t * des, const T *src) {
	des[0] = (src[0] & 4194303);
	des[0] |= (src[1] & 4194303) << 22;
	des[1] = (src[1] & 4194303) >> 10;
	des[1] |= (src[2] & 4194303) << 12;
	des[2] = (src[2] & 4194303) >> 20;
	des[2] |= (src[3] & 4194303) << 2;
	des[2] |= (src[4] & 4194303) << 24;
	des[3] = (src[4] & 4194303) >> 8;
	des[3] |= (src[5] & 4194303) << 14;
	des[4] = (src[5] & 4194303) >> 18;
	des[4] |= (src[6] & 4194303) << 4;
	des[4] |= (src[7] & 4194303) << 26;
	des[5] = (src[7] & 4194303) >> 6;
}

template<typename T>
void AFOR_pack_8_23(uint32_t * des, const T *src) {
	des[0] = (src[0] & 8388607);
	des[0] |= (src[1] & 8388607) << 23;
	des[1] = (src[1] & 8388607) >> 9;
	des[1] |= (src[2] & 8388607) << 14;
	des[2] = (src[2] & 8388607) >> 18;
	des[2] |= (src[3] & 8388607) << 5;
	des[2] |= (src[4] & 8388607) << 28;
	des[3] = (src[4] & 8388607) >> 4;
	des[3] |= (src[5] & 8388607) << 19;
	des[4] = (src[5] & 8388607) >> 13;
	des[4] |= (src[6] & 8388607) << 10;
	des[5] = (src[6] & 8388607) >> 22;
	des[5] |= (src[7] & 8388607) << 1;
}

template<typename T>
void AFOR_pack_8_24(uint32_t * des, const T *src) {
	des[0] = (src[0] & 16777215);
	des[0] |= (src[1] & 16777215) << 24;
	des[1] = (src[1] & 16777215) >> 8;
	des[1] |= (src[2] & 16777215) << 16;
	des[2] = (src[2] & 16777215) >> 16;
	des[2] |= (src[3] & 16777215) << 8;
	des[3] = (src[4] & 16777215);
	des[3] |= (src[5] & 16777215) << 24;
	des[4] = (src[5] & 16777215) >> 8;
	des[4] |= (src[6] & 16777215) << 16;
	des[5] = (src[6] & 16777215) >> 16;
	des[5] |= (src[7] & 16777215) << 8;
}

template<typename T>
void AFOR_pack_8_25(uint32_t * des, const T *src) {
	des[0] = (src[0] & 33554431);
	des[0] |= (src[1] & 33554431) << 25;
	des[1] = (src[1] & 33554431) >> 7;
	des[1] |= (src[2] & 33554431) << 18;
	des[2] = (src[2] & 33554431) >> 14;
	des[2] |= (src[3] & 33554431) << 11;
	des[3] = (src[3] & 33554431) >> 21;
	des[3] |= (src[4] & 33554431) << 4;
	des[3] |= (src[5] & 33554431) << 29;
	des[4] = (src[5] & 33554431) >> 3;
	des[4] |= (src[6] & 33554431) << 22;
	des[5] = (src[6] & 33554431) >> 10;
	des[5] |= (src[7] & 33554431) << 15;
	des[6] = (src[7] & 33554431) >> 17;
}

template<typename T>
void AFOR_pack_8_26(uint32_t * des, const T *src) {
	des[0] = (src[0] & 67108863);
	des[0] |= (src[1] & 67108863) << 26;
	des[1] = (src[1] & 67108863) >> 6;
	des[1] |= (src[2] & 67108863) << 20;
	des[2] = (src[2] & 67108863) >> 12;
	des[2] |= (src[3] & 67108863) << 14;
	des[3] = (src[3] & 67108863) >> 18;
	des[3] |= (src[4] & 67108863) << 8;
	des[4] = (src[4] & 67108863) >> 24;
	des[4] |= (src[5] & 67108863) << 2;
	des[4] |= (src[6] & 67108863) << 28;
	des[5] = (src[6] & 67108863) >> 4;
	des[5] |= (src[7] & 67108863) << 22;
	des[6] = (src[7] & 67108863) >> 10;
}

template<typename T>
void AFOR_pack_8_27(uint32_t * des, const T *src) {
	des[0] = (src[0] & 134217727);
	des[0] |= (src[1] & 134217727) << 27;
	des[1] = (src[1] & 134217727) >> 5;
	des[1] |= (src[2] & 134217727) << 22;
	des[2] = (src[2] & 134217727) >> 10;
	des[2] |= (src[3] & 134217727) << 17;
	des[3] = (src[3] & 134217727) >> 15;
	des[3] |= (src[4] & 134217727) << 12;
	des[4] = (src[4] & 134217727) >> 20;
	des[4] |= (src[5] & 134217727) << 7;
	des[5] = (src[5] & 134217727) >> 25;
	des[5] |= (src[6] & 134217727) << 2;
	des[5] |= (src[7] & 134217727) << 29;
	des[6] = (src[7] & 134217727) >> 3;
}

template<typename T>
void AFOR_pack_8_28(uint32_t * des, const T *src) {
	des[0] = (src[0] & 268435455);
	des[0] |= (src[1] & 268435455) << 28;
	des[1] = (src[1] & 268435455) >> 4;
	des[1] |= (src[2] & 268435455) << 24;
	des[2] = (src[2] & 268435455) >> 8;
	des[2] |= (src[3] & 268435455) << 20;
	des[3] = (src[3] & 268435455) >> 12;
	des[3] |= (src[4] & 268435455) << 16;
	des[4] = (src[4] & 268435455) >> 16;
	des[4] |= (src[5] & 268435455) << 12;
	des[5] = (src[5] & 268435455) >> 20;
	des[5] |= (src[6] & 268435455) << 8;
	des[6] = (src[6] & 268435455) >> 24;
	des[6] |= (src[7] & 268435455) << 4;
}

template<typename T>
void AFOR_pack_8_29(uint32_t * des, const T *src) {
	des[0] = (src[0] & 536870911);
	des[0] |= (src[1] & 536870911) << 29;
	des[1] = (src[1] & 536870911) >> 3;
	des[1] |= (src[2] & 536870911) << 26;
	des[2] = (src[2] & 536870911) >> 6;
	des[2] |= (src[3] & 536870911) << 23;
	des[3] = (src[3] & 536870911) >> 9;
	des[3] |= (src[4] & 536870911) << 20;
	des[4] = (src[4] & 536870911) >> 12;
	des[4] |= (src[5] & 536870911) << 17;
	des[5] = (src[5] & 536870911) >> 15;
	des[5] |= (src[6] & 536870911) << 14;
	des[6] = (src[6] & 536870911) >> 18;
	des[6] |= (src[7] & 536870911) << 11;
	des[7] = (src[7] & 536870911) >> 21;
}

template<typename T>
void AFOR_pack_8_30(uint32_t * des, const T *src) {
	des[0] = (src[0] & 1073741823);
	des[0] |= (src[1] & 1073741823) << 30;
	des[1] = (src[1] & 1073741823) >> 2;
	des[1] |= (src[2] & 1073741823) << 28;
	des[2] = (src[2] & 1073741823) >> 4;
	des[2] |= (src[3] & 1073741823) << 26;
	des[3] = (src[3] & 1073741823) >> 6;
	des[3] |= (src[4] & 1073741823) << 24;
	des[4] = (src[4] & 1073741823) >> 8;
	des[4] |= (src[5] & 1073741823) << 22;
	des[5] = (src[5] & 1073741823) >> 10;
	des[5] |= (src[6] & 1073741823) << 20;
	des[6] = (src[6] & 1073741823) >> 12;
	des[6] |= (src[7] & 1073741823) << 18;
	des[7] = (src[7] & 1073741823) >> 14;
}

template<typename T>
void AFOR_pack_8_31(uint32_t * des, const T *src) {
	des[0] = (src[0] & 2147483647);
	des[0] |= (src[1] & 2147483647) << 31;
	des[1] = (src[1] & 2147483647) >> 1;
	des[1] |= (src[2] & 2147483647) << 30;
	des[2] = (src[2] & 2147483647) >> 2;
	des[2] |= (src[3] & 2147483647) << 29;
	des[3] = (src[3] & 2147483647) >> 3;
	des[3] |= (src[4] & 2147483647) << 28;
	des[4] = (src[4] & 2147483647) >> 4;
	des[4] |= (src[5] & 2147483647) << 27;
	des[5] = (src[5] & 2147483647) >> 5;
	des[5] |= (src[6] & 2147483647) << 26;
	des[6] = (src[6] & 2147483647) >> 6;
	des[6] |= (src[7] & 2147483647) << 25;
	des[7] = (src[7] & 2147483647) >> 7;
}

template<typename T>
void AFOR_pack_8_32(uint32_t * des, const T *src) {
	des[0] |= (src[0]);
	des[1] |= (src[1]);
	des[2] |= (src[2]);
	des[3] |= (src[3]);
	des[4] |= (src[4]);
	des[5] |= (src[5]);
	des[6] |= (src[6]);
	des[7] |= (src[7]);
}


}
}


#endif /* AFOR_PACK_HPP_ */


/*
 *
Meta code:

#include <iostream>
#include <sstream>
#include <string>
#include <stdint.h>

using namespace std;

string Int2Str(int num) {
	ostringstream oss;
	oss << num;
	return oss.str();
}


string GenCode(int num) {
	ostringstream oss;
	for (int i=1; i<=32; i++) {
		oss << "template<typename T>" << endl;
		oss << "void AFOR_pack_" << num << "_" << i << "(uint32_t * des, const T *src) {" << endl;
		int offsetInWord = 0;
		int curWordIdx = 0;
		int j = 0;
		uint32_t mask  = (1LL << i) - 1;
		while (j < num) {
			int newBitWidth = offsetInWord + i - 32;
			if (newBitWidth >= 0) {
				ostringstream tmp1;
				tmp1 << "\t" << "des[" << curWordIdx << "] |= (src[" << j << "]";
				if (i < 32)
					tmp1 << " & " << mask;
				tmp1 << ")";
				if (offsetInWord > 0)
					tmp1 << " << " << offsetInWord;
				tmp1 << ";" << endl;
                        	oss << tmp1.str();
				curWordIdx += (offsetInWord + i) / 32;
				offsetInWord = (offsetInWord + i) % 32;

				if (newBitWidth > 0) {
					ostringstream tmp2;
					tmp2 << "\t" << "des[" << curWordIdx << "] = (src[" << j << "]";
					if (i < 32)
						tmp2 << " & " << mask;
					tmp2 << ")";
					tmp2 << " >> " << i - newBitWidth;
					tmp2 << ";" << endl;
                        		oss << tmp2.str();
				}

			} else {
				ostringstream tmp1;
				tmp1 << "\t" << "des[" << curWordIdx << "] ";
				if (offsetInWord > 0)
					tmp1 << "|=";
				else
					tmp1 << "=";
				tmp1 << " (src[" << j << "]";
				if (i < 32)
					tmp1 << " & " << mask;
				tmp1 << ")";
				if (offsetInWord > 0)
					tmp1 << " << " << offsetInWord;
				tmp1 << ";" << endl;
                        	oss << tmp1.str();

				curWordIdx += (offsetInWord + i) / 32;
				offsetInWord = (offsetInWord + i) % 32;
			}

			j++;
		}
		oss << "}" << endl;
		oss << endl;

	}
	return oss.str();

}


int main() {
	cout << GenCode(32);
	cout << GenCode(16);
	cout << GenCode(8);
	return 0;
}


 *
 */
